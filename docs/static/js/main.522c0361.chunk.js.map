{"version":3,"sources":["general/HeaderViz/HeaderViz.js","general/BodyViz/BodyViz.js","general/MainMenu/MainMenu.js","general/Loading/Loading.js","visualizations/TimeFilter/time-filter.d3.js","visualizations/TimeFilter/TimeFilter.js","general/DropDownSelect/DropDownSelect.js","general/SetOption/SetOption.js","visualizations/PlacesMatrix/matrix.d3.js","PlacesMatrixView/parse-matrix-data.js","visualizations/PlacesMatrix/PlacesMatrix.js","PlacesMatrixView/PlacesMatrixView.js","App.js","serviceWorker.js","index.js"],"names":["HeaderViz","className","style","this","props","children","Component","BodyViz","MainMenu","Loading","Viz","el","data","changeSpan","margin","top","right","bottom","getBoundingClientRect","height","left","svg","d3","width","append","attr","classed","x","range","domain","d","xAxis","brush","extent","handleSize","m","on","brushed","context","info","selectAll","line","dotted","call","move","span","exit","remove","enter","i","scale","getAnchor","text","getFullYear","merge","_groups","getBBox","sourceEvent","type","selection","map","invert","Date","update","TimeFilter","bind","_chart","initialize","_rootNode","destroy","componentNode","title","id","ref","_setRef","defaultProps","DropDownSelect","handleChange","e","selectedThemes","target","value","changeOptions","onChange","options","key","SetOption","newValue","checked","selected","graph","storedFilters","y","r","color","xAxisCall","yAxisCall","g","hull","link","node","label","information","simulation","ParseMatrixData","rawData","forEach","year","handleHierarchies","calculateNetwork","nodes","hierarchies","part_of","entries","filter","values","part_of_d","find","subNodes","totalSubNodes","length","part_of_e","f","part_of_f","part_of_g","h","edges","source","n","obj","push","V","categories","categoriesColors","links","hullsData","last","openAllState","reset","toggleSubnodes","noRestart","opened","fx","fy","subNodes2Remove","hulls2Remove","collectSubNodes","parentNode","childNode","toRemove","filtered","includes","thisHull","subNode","thisHullNodes","concat","indexOf","augmentedNodes","console","log","filters","rootNodes","padding","tickSize","tickFormat","replace","exponent","select","step","force","strength","distance","iterations","points","convexHull","roundedHull","stop","openAll","timeFilter","date","selectedPublications","publicationType","themes","category","sourceTitle","timeStamp","darker","kind","alpha","restart","hullPadding","vecScale","v","vecSum","pv1","pv2","unitNormal","p0","p1","nLength","Math","sqrt","polyPoints","roundedHull1","roundedHull2","segments","Array","segmentIndex","offset","arcData","join","segment","index","pathFragment","p2","offsetVector","invOffsetVector","p3","PlacesMatrix","PlacesMatrixView","loadData","state","isLoading","changeThemes","changePublications","then","parser","setState","dataTimeFilter","publicationsTypes","newSpan","newThemes","newPublications","gridColumn","display","App","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.522c0361.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport './HeaderViz.css';\n\nclass HeaderViz extends Component {\n  render() {\n    return (\n      <div className=\"the-header\" style={this.props.style}>{this.props.children}</div>\n    );\n  }\n}\n\nexport default HeaderViz;\n","import React, { Component } from 'react';\nimport './BodyViz.css';\n\nclass BodyViz extends Component {\n  render() {\n    return <div className={this.props.className}>{this.props.children}</div>;\n  }\n}\n\nexport default BodyViz;\n","import React, { Component } from 'react';\nimport './MainMenu.css';\n\nclass MainMenu extends Component {\n  render() {\n    return <div className=\"main-menu\" style={this.props.style}>M</div>;\n  }\n}\n\nexport default MainMenu;\n","import React, { Component } from 'react';\n\nclass Loading extends Component {\n  render() {\n    return <div style={this.props.style}>Loading ...</div>;\n  }\n}\n\nexport default Loading;\n","import * as d3 from 'd3';\n\nconst Viz = {};\n\nViz.initialize = (el, data, changeSpan) => {\n  // console.log('initialized')\n\n  // data must be an array with 2+ elements. Element is a Date object\n\n  // Important to declare at beginning\n  Viz.changeSpan = changeSpan;\n\n  const m = 15;\n  Viz.margin = { top: 0, right: m, bottom: el.getBoundingClientRect().height - 20, left: m }\n  Viz.svg = d3.select(el);\n  Viz.width = el.getBoundingClientRect().width - Viz.margin.left - Viz.margin.right;\n  Viz.height = el.getBoundingClientRect().height - Viz.margin.top - Viz.margin.bottom;\n\n  Viz.svg.append(\"defs\").append(\"clipPath\")\n      .attr(\"id\", \"timeclip\")\n    .append('rect')\n      .classed('clip', true)\n      .attr('x', 0)\n      .attr('y', Viz.margin.top)\n      .attr('width', Viz.width + Viz.margin.left + Viz.margin.right)\n      .attr('height', Viz.height)\n      // the following to compensate the translation on VIz.context (even if not totally clear)\n      .attr(\"transform\", \"translate(\" + -Viz.margin.left + \",\" + -Viz.margin.top + \")\")\n\n  Viz.x = d3.scaleTime()\n    .range([0, Viz.width])\n    .domain(d3.extent(data, d => d));\n\n  Viz.xAxis = d3.axisBottom(Viz.x)\n\n  Viz.brush = d3.brushX()\n    .extent([[0, 0], [Viz.width, Viz.height]])\n    .handleSize(m*2)\n    .on(\"brush end\", brushed);\n\n  Viz.context = Viz.svg.append(\"g\")\n    .attr(\"class\", \"context\")\n    .attr(\"transform\", \"translate(\" + Viz.margin.left + \",\" + Viz.margin.top + \")\")\n\n  // important is before brushed is called or assigned\n  Viz.info = Viz.context.append('g').selectAll('.info')\n  Viz.line = Viz.context.append('g').selectAll('.info-line')\n  Viz.dotted = Viz.context.append('g').selectAll('.dotted')\n\n  Viz.context.append(\"line\")\n    .attr('x1', 0)\n    .attr('y1', Viz.height/2)\n    .attr('x2', Viz.width)\n    .attr('y2', Viz.height/2)\n    .attr('stroke', 'var(--dark-green)')\n\n  Viz.context.append(\"g\")\n    .attr(\"class\", \"brush\")\n    .call(Viz.brush)\n    .call(Viz.brush.move, Viz.x.range())\n}\n\nViz.update = (span) => {\n  // console.log('updated')\n\n  Viz.info = Viz.info.data(span, d=>d);\n  Viz.info.exit().remove()\n  Viz.info = Viz.info.enter().append('text')\n    .attr('class','info')\n    .attr('x', d => { return Viz.x(d) })\n    .attr('y', Viz.height + Viz.margin.top + 12) // this value depends on the font-size\n    .attr('text-anchor', (d,i) => {\n      function getAnchor(d,scale, width) {\n        let anchor;\n        if (i%2===0) {\n          if (scale(d) >= width/4) {\n            anchor = 'end';\n          } else {\n            anchor = 'start';\n          }\n        } else {\n          if (scale(d) <= width/4*3) {\n            anchor = 'start';\n          } else {\n            anchor = 'end';\n          }\n        }\n        return anchor;\n      }\n      return getAnchor(d, Viz.x, Viz.width);\n    })\n    .text(d=>{\n      return d.getFullYear()\n    })\n    .merge(Viz.info)\n\n  Viz.line = Viz.line.data(span, d=>d);\n  Viz.line.exit().remove()\n  Viz.line = Viz.line.enter().append('line')\n    .attr('class','info-line')\n    .attr('stroke', 'var(--calvino-red)')\n    .attr('stroke-width', '2px')\n    .attr('x1', d => { return Viz.x(d) })\n    .attr('y1', 0)\n    .attr('x2', d => { return Viz.x(d) })\n    .attr('y2', Viz.height)\n    .merge(Viz.line)\n\n  Viz.dotted = Viz.dotted.data([span], (d,i)=>{return d})\n  Viz.dotted.exit().remove()\n  Viz.dotted = Viz.dotted.enter().append('line')\n    .attr('class','dotted')\n    .attr('x1', Viz.info._groups[0][0].getBBox().x + Viz.info._groups[0][0].getBBox().width + 5 )\n    .attr('x2', Viz.info._groups[0][1].getBBox().x - 5)\n    .attr('y1', Viz.height + Viz.margin.top + 6)\n    .attr('y2', Viz.height + Viz.margin.top + 6)\n    .attr('stroke-width', '1.5px')\n    .attr('stroke', 'var(--dark-green)')\n    .attr('stroke-linecap', 'round')\n    .attr('stroke-dasharray', '0,15')\n    .merge(Viz.dotted)\n}\n\nViz.destroy = (el) => {}\n\nexport default Viz\n\nfunction brushed() {\n  if (d3.event.sourceEvent && d3.event.sourceEvent.type === \"zoom\") return; // ignore brush-by-zoom\n  if (d3.event.selection) {\n    var span = d3.event.selection || Viz.x.range();\n    span = span.map(d=>{return Viz.x.invert(d)})\n    Viz.changeSpan(span)\n    span = span.map(d=> new Date(d));\n    Viz.update(span)\n  }\n}\n","import React, { Component } from 'react';\nimport './TimeFilter.css';\nimport Viz from './time-filter.d3'\n\nclass TimeFilter extends Component {\n  constructor(props) {\n    super(props);\n    this.changeSpan = this.changeSpan.bind(this);\n  }\n\n  changeSpan(span) {\n    this.props.changeSpan(span);\n  }\n\n  componentDidMount() {\n    this._chart = Viz.initialize(this._rootNode, this.props.data, this.changeSpan);\n  }\n\n  componentDidUpdate() {\n    // Viz.update(this.props.data);\n  }\n\n  componentWillUnmount() {\n    Viz.destroy(this._rootNode);\n  }\n\n  _setRef(componentNode) {\n      this._rootNode = componentNode;\n  }\n\n  render() {\n    return (\n      <div style={this.props.style}>\n        <h5>{this.props.title}</h5>\n        <svg id=\"time-filter\" ref={this._setRef.bind(this)}></svg>\n      </div>\n    );\n  }\n}\n\nexport default TimeFilter;\n\nTimeFilter.defaultProps = { title: 'Time Filter' };\n","import React, { Component } from 'react';\n\nclass DropDownSelect extends Component {\n  constructor(props) {\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  handleChange(e) {\n    const selectedThemes = e.target.value\n    this.props.changeOptions(selectedThemes);\n  }\n\n  render() {\n    return (\n      <div style={this.props.style}>\n        <h5>{this.props.title}</h5>\n        <select id={this.props.id} onChange={this.handleChange}>\n          {\n            this.props.options.map( (d,i) => {\n              return <option key={i}>{d}</option>\n            })\n          }\n        </select>\n      </div>\n    );\n  }\n}\n\nexport default DropDownSelect;\n\nDropDownSelect.defaultProps = { title: 'Select an option' };\n","import React, { Component } from 'react';\nimport './SetOption.css'\n\nclass SetOption extends Component {\n\n  constructor(props) {\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  handleChange(e) {\n    const newValue = e.target.checked;\n    this.props.selected(newValue);\n  }\n\n  render() {\n    return (\n      <div className=\"set-option\" style={this.props.style}>\n        <h5>{this.props.title}</h5>\n        <label className=\"switch\">\n          <input type=\"checkbox\" onChange={this.handleChange}/>\n          <span className=\"slider round\"></span>\n        </label>\n      </div>\n    );\n  }\n}\n\nexport default SetOption;\n\nSetOption.defaultProps = { title: 'Option' };\n","import * as d3 from 'd3';\nimport ParseMatrixData from '../../PlacesMatrixView/parse-matrix-data';\n\nconst V = {}\n\nconst categories = [\n\t'generico_non_terrestre',\n\t'nominato_non_terrestre',\n\t'nominato_terrestre',\n\t'generico_terrestre',\n\t'inventato',\n\t'no_ambientazione'\n]\n\nconst categoriesColors = [\n\t'#3131ff',\n\t'#bbbbff',\n\t'#ffce00',\n\t'#ff6c39',\n\t'#00c19c',\n\t'#cecece'\n]\n\nconst collisionPadding = 0.75;\n\n// data\nlet graph, nodes = [], links = [], hullsData = [], rootNodes = [], storedFilters, last=0, openAllState=false\n\n// Dimensions and scales\nlet x, y, r, color, margin, width, height;\nlet xAxisCall, yAxisCall;\nmargin = { 'top': 0, 'right': 50, 'bottom': 75, 'left': 50 }\n\n// elements\nlet svg, g, xAxis, yAxis, hull, link, node, label, information\n\n// force-layout\nlet simulation\n\nfunction reset() {\n  node.style('opacity', 1);\n  label.classed('selected', false).style('display', 'none');\n  // remove work title\n  information = information.data([], function(d) { return d.id; });\n  information.exit().remove();\n}\n\nfunction toggleSubnodes(d, noRestart) {\n  if (d.opened) {\n    d.opened = false;\n    d.fx = null;\n    d.fy = null;\n\n    var subNodes2Remove = [];\n    var hulls2Remove = [d.id]\n\n    // recursive functions, it makes possible to close contained cluster of nodes\n    function collectSubNodes(parentNode) {\n      // console.log(`There are ${parentNode.subNodes.length} sub-nodes of ${parentNode.label}`)\n      parentNode.subNodes.forEach( childNode => {\n        if (childNode.opened) {\n          childNode.opened = false;\n          hulls2Remove.push(childNode.id);\n          collectSubNodes(childNode);\n        }\n      });\n      subNodes2Remove.push(parentNode.subNodes);\n      // console.log(`${parentNode.label} has ${parentNode.subNodes} nodes to be removed`);\n    }\n\n    collectSubNodes(d);\n\n    // cycle in the subNodes2Remove array and for each list of sub-nodes to be removed remove and re-calculate the network.\n    // Probably not the best way, but the simplest at the moment of the coding.\n    subNodes2Remove.forEach( subNodes => {\n\n      let toRemove = subNodes.map( d => d.id)\n      let filtered = nodes.filter( el => {\n        return !toRemove.includes( el.id );\n      })\n\n      // remove this hull\n      hullsData = hullsData.filter(function(h){\n        return !hulls2Remove.includes( h[0].id );\n      })\n\n      // remove extra points from the outer hull\n      hullsData.forEach(function(thisHull,i){\n        hullsData[i] = thisHull.filter(function(n){\n          return !toRemove.includes( n.id );\n        })\n      })\n\n      // calculate graph\n      graph = ParseMatrixData.calculateNetwork(filtered)\n    } )\n\n    if (noRestart !== false) {\n      V.update(graph, storedFilters);\n    }\n    // important to return here so to not do the following instructions\n    return;\n  }\n  if (d.subNodes && d.subNodes.length){\n    d.subNodes.forEach(function(subNode, i){\n      if (i > 0) {\n        subNode.x = d.x;\n        subNode.y = d.y;\n      }\n    })\n    d.opened = true;\n\n    // Make convex hull\n    var thisHullNodes = [d].concat(d.subNodes); // first element in array is always the one opened, so we can use its ID as identifier for the convex hull\n    hullsData.push(thisHullNodes);\n\n    // check if the first point of the hull is inside another hulls\n    // if so it means this hull should be part of that opened\n    // add these points to that hullsData\n    hullsData.forEach(function(thisHull){\n      // if the element is in the array, but is not the first\n      if (thisHull.indexOf(thisHullNodes[0]) > 0) {\n        thisHullNodes.forEach(function(n,i){\n          if (i !== 0) {\n            thisHull.push(n);\n          }\n        })\n      }\n    })\n\n    // calculate Graph\n    var augmentedNodes = nodes.concat(d.subNodes);\n    graph = ParseMatrixData.calculateNetwork(augmentedNodes);\n    nodes = graph.nodes;\n    links = graph.edges;\n    if (noRestart !== false) {\n      V.update(graph, storedFilters);\n    }\n  } else {\n    console.log('No nodes to expand')\n  }\n}\n\nfunction highlightNodes(arr){\n  arr.forEach( d => {\n    node.filter(function(e){ return e.source !== d.source; }).style('opacity', 0.1);\n    label.filter(function(e){ return d.id === e.id }).classed('selected', true).style('display','block');\n  })\n}\n\nV.initialize = (el, data, filters) => {\n  console.log('init',data, filters)\n\n  // Since React calls the update without data, at the beginning store data\n  // so that when time-filter is used (and React calls update) there is data to use\n  graph = data\n  rootNodes = graph.rootNodes;\n\n  // //get themes\n  // let themes = []\n  // d3.nest()\n  //   .key(d=>d.theme)\n  //   .entries(graph.nodes)\n  //   .map(d=>d.key)\n  //   .forEach(d=>{ themes = themes.concat(d.split(';')) });\n  // themes = d3.nest()\n  //   .key(d=>d)\n  //   .entries(themes)\n  //   .map(d=>d.key)\n  //   .sort();\n  // console.log(JSON.stringify(themes))\n\n  // Root and dimensions\n  svg = d3.select(el).style('touch-action', 'manipulation');\n  width = svg.node().getBoundingClientRect().width - margin.left - margin.right;\n  height = svg.node().getBoundingClientRect().height - margin.top - margin.bottom;\n\n  // Scales\n  x = d3.scaleTime()\n    .range([0, width])\n    .domain(d3.extent(data.nodes, d=>d.year));\n  xAxisCall = d3.axisBottom(x)//.ticks(d3.timeYear.every(1))\n  y = d3.scalePoint()\n    .range([0, height])\n    .padding(0.5);\n  yAxisCall = d3.axisRight(y).tickSize(width)\n\t\t.tickFormat(function(d){\n\t\t\td = d.replace(/_/g, ' ')\n\t\t\treturn d;\n\t\t})\n  y.domain(categories)\n  r = d3.scalePow()\n    .exponent(0.5)\n    // .range([15,75])\n    .range([3.5,25])\n    .domain([1,d3.max(data.nodes, function(d){ return d.totalSubNodes })])\n  color = d3.scaleOrdinal().domain(categories).range(categoriesColors)\n\n\n  // elements\n  svg.append('rect')\n  \t.classed('reset', true)\n  \t.attr('x', margin.left)\n  \t.attr('width', width)\n  \t.attr('height', height)\n  \t.attr('fill', 'transparent')\n  \t.on('click', reset);\n  g = svg.append('g').attr(\"transform\", `translate(${margin.left},${margin.top})`)\n  xAxis = g.append(\"g\").attr(\"class\", \"x-axis\")\n  yAxis = g.append('g').attr(\"class\", \"y-axis\")\n\n  yAxis\n    .attr(\"transform\", `translate(0, 0)`)\n    .call(yAxisCall)\n    .call(g => g.selectAll(\".tick text\")\n          .style(\"text-transform\", \"capitalize\"))\n    .call(g => g.select(\".domain\")\n          .remove())\n      .call(g => g.selectAll(\".tick line\")\n          .attr(\"stroke-opacity\", 0.5)\n          .attr(\"stroke-dasharray\", \"2,2\"))\n      .call(g => g.selectAll(\".tick text\")\n          .attr(\"x\", 4)\n          .attr(\"dy\", -y.step()/10));\n\n  link = g.append('g').classed('links', true).selectAll('.link');\n  hull = g.append('g').classed('hulls', true).selectAll('.hull');\n  node = g.append('g').classed('nodes', true).selectAll('.node');\n  label = g.append('g').classed('labels', true).selectAll('.label');\n  information = g.append('g').classed('informations', true).selectAll('.information');\n\n  simulation = d3.forceSimulation(nodes)\n  \t.force(\"charge\", d3.forceManyBody().strength(-1))\n  \t.force(\"link\", d3.forceLink()\n  \t\t.strength( 0.35 )\n  \t\t.distance( r.range()[0] + 1 )\n  \t\t.id(function(d) { return d.id; })\n  \t)\n  \t.force(\"x\", d3.forceX(function(d) { return d.x })\n  \t\t.strength(function(d) {\n  \t\t\treturn d.part_of === '' ? 1 : 0;\n  \t\t})\n  \t)\n  \t.force(\"y\", d3.forceY(function(d) { return d.y })\n  \t\t.strength(function(d) { return d.part_of === '' ? 0.7 : 0; })\n  \t)\n  \t.force(\"collision\", d3.forceCollide(function(d){\n  \t\t\treturn d.opened ? r(1)+collisionPadding : r(d.totalSubNodes + 1)+collisionPadding\n  \t\t})\n  \t\t.iterations(32)\n  \t\t.strength(.5)\n  \t)\n  \t.on(\"tick\", ticked)\n    .on(\"end\", () => { console.log('simulation ended') })\n    .stop()\n\n  function ticked() {\n    // console.log(simulation.alpha())\n  \tnode.attr(\"cx\", function(d) { return d.x; })\n  \t\t.attr(\"cy\", function(d) { return d.y; });\n\n  \tlabel.attr(\"x\", function(d) { return d.x; })\n  \t\t.attr(\"y\", function(d) { return d.y; });\n\n  \tlink.attr(\"x1\", function(d) { return d.source.x; })\n  \t\t.attr(\"y1\", function(d) { return d.source.y; })\n  \t\t.attr(\"x2\", function(d) { return d.target.x; })\n  \t\t.attr(\"y2\", function(d) { return d.target.y; });\n\n  \thull.attr(\"d\", function(d){\n  \t\tlet thisHullPoints = d.map( d => { return [d.x, d.y] });\n  \t\tvar points = thisHullPoints;\n  \t\tvar convexHull = (points.length < 3) ? points : d3.polygonHull(points);\n  \t\treturn roundedHull(convexHull, d);\n  \t})\n  }\n\n  V.update(data, filters)\n}\n\nV.update = (data, filters) => {\n  console.log('update viz')\n\n  // This is because react must calls the update without data\n  if (!data) data = graph\n  nodes = data.nodes;\n  links = data.edges;\n\n  if (filters) {\n    // store filters\n    storedFilters = filters\n    // do filters here\n    if (filters.openAll != openAllState) {\n      console.log('open or close all', filters.openAll)\n      openAllState = filters.openAll\n    }\n    if (filters.timeFilter) {\n      nodes = nodes.filter( d => {\n        const date = new Date(d.year)\n        return date >= filters.timeFilter[0] && date <= filters.timeFilter[1]\n      })\n    }\n    if (filters.selectedPublications) {\n      if (filters.selectedPublications === 'tutti') {\n        node.classed('faded', false)\n      } else {\n        node.classed('faded', false).classed('faded', d => {\n          if (filters.selectedPublications === 'altro') {\n            return  !d.publicationType == \"\"\n          } else {\n            return !d.publicationType.includes(filters.selectedPublications)\n          }\n        })\n      }\n    }\n    if (filters.selectedThemes) {\n      if (filters.selectedThemes === 'tutti') {\n        node.classed('faded', false)\n      } else {\n        node.classed('faded', false).classed('faded', d => {\n          if (d.themes) {\n            return !d.themes.includes(filters.selectedThemes)\n          } else {\n            return true\n          }\n        })\n      }\n    }\n  }\n\n  if (filters.update) {\n    x.domain(d3.extent(nodes, d=>d.year))\n    xAxis.attr(\"transform\", `translate(${0}, ${height})`).call(xAxisCall)\n\n    // Set x and y of subNodes\n    data.nodes.forEach(d => {\n      if (d.opened) {\n        d.fx = x(d.year)\n      }\n      d.x = x(d.year)\n      d.y = y(d.category)\n    })\n\n    // Update the force layout\n    simulation.force(\"x\").x(function(d) { return d.x })\n\n    node = node.data(nodes, d => { return d.id })\n    node.exit().remove();\n    node = node.enter().append('circle')\n      .attr('class', d => `node`)\n      .on('click', function(d){\n        highlightNodes([d]);\n\n  \t\t\t// show work title\n  \t\t\tinformation = information.data([d], function(d) { return d.id; });\n  \t\t\tinformation.exit().remove();\n  \t\t\tinformation = information.enter().append(\"text\")\n  \t\t\t\t.classed('information', true)\n  \t\t\t\t.classed('label', true)\n  \t\t\t\t.attr('text-anchor', d => (x(d.year) >= width/2) ? 'end' : 'start')\n  \t\t\t\t.attr('x', d => (x(d.year) >= width/2) ? x(d.year)+4.8 : x(d.year)-3.2)\n  \t\t\t\t.attr('y', height - 10)\n  \t\t\t\t.text( d => (x(d.year) >= width/2) ? d.sourceTitle + ' ↓' : '↓ ' + d.sourceTitle)\n  \t\t\t\t.merge(information);\n\n  \t\t\t// get the double tap\n  \t\t\tif ((d3.event.timeStamp - last) < 500) {\n  \t\t\t\td.fx = d.x*1;\n  \t\t\t\td.fy = d.y*1;\n          toggleSubnodes(d);\n        }\n        last = d3.event.timeStamp;\n  \t\t})\n      .attr('key', d=> d.id)\n      .attr('cx', d => {\n        return d.x\n      })\n      .attr('cy', d => {\n        return d.y\n      })\n      .merge(node)\n      .style('cursor', function(d){ return d.subNodes && d.subNodes.length ? 'pointer' : 'auto'; })\n  \t\t.attr(\"fill\", function(d) { return d.opened===true ? 'white' : color(d.category); })\n  \t\t.attr('stroke', function(d) { if(d.totalSubNodes > 0) return d3.color(color(d.category)).darker(0.7) })\n      .style('opacity', 1)\n      .attr(\"r\", function(d){ return d.opened ? r(1) : r(d.totalSubNodes + 1) }) // +1 means plus itself\n\n    // Apply the general update pattern to the links.\n  \tlink = link.data(links, function(d) {\n  \t\treturn d.source.id + \"-\" + d.target.id;\n  \t});\n  \tlink.exit().remove();\n  \tlink = link.enter().append(\"line\")\n  \t\t.classed('link', true)\n  \t\t.classed('part-of', function(d) { return d.kind === 'part_of' })\n      .attr('stroke-width', 0.5)\n      .attr('stroke', '#ccc')\n  \t\t.on('click', d => console.log(d))\n  \t\t.merge(link);\n\n  \t// Apply the general update pattern to the labels.\n  \tlabel = label.data(nodes, function(d) { return d.id; });\n  \tlabel.exit().remove();\n  \tlabel = label.enter().append(\"text\")\n  \t\t.classed('label', true)\n  \t\t.style('display', 'none')\n  \t\t.attr('text-anchor', 'middle')\n      .style('pointer-events', 'none')\n  \t\t.text(function(d){return d.label})\n  \t\t.merge(label);\n\n  \t// Apply the general update pattern to the convex hulls.\n  \thull = hull.data(hullsData, function(d) {\n  \t\treturn d[0].id;\n  \t});\n  \thull.exit().remove();\n  \thull = hull.enter().append(\"path\")\n  \t\t.classed('hull', true)\n  \t\t.attr('fill', function(d){\n  \t\t\treturn color(d[0].category)\n  \t\t})\n  \t\t.style('opacity', .25)\n  \t\t.on('click', d => {\n  \t\t\t// d3.event.preventDefault;\n  \t\t\t// get the double tap\n  \t\t\tif ((d3.event.timeStamp - last) < 500) {\n          toggleSubnodes(d[0]);\n        }\n        last = d3.event.timeStamp;\n  \t\t})\n  \t\t.merge(hull);\n\n    simulation.nodes(nodes);\n  \tsimulation.force(\"link\").links(links);\n  \tsimulation.alpha(1).restart();\n  }\n\n}\n\n// V.openAll = () => {\n// \trunAll(rootNodes);\n// \tfunction runAll(nodesList) {\n// \t\tnodesList.forEach( n => {\n// \t\t\tif (n.totalSubNodes > 0) {\n// \t\t\t\ttoggleSubnodes(n, false);\n// \t\t\t\trunAll(n.subNodes);\n// \t\t\t}\n// \t\t});\n// \t}\n// \trestart();\n// }\n//\n// V.closeAll = () => {\n// \trootNodes.forEach( d => {\n// \t\ttoggleSubnodes(d, false);\n// \t})\n// \trestart();\n// }\n\nV.destroy = () => {}\n\nexport default V\n\n//\n//\n//\n//\n// convex hull from http://bl.ocks.org/hollasch/f70f1fe7700f092b5a505e3efd1d9232\n//\n//\n//\n//\n\nvar hullPadding = collisionPadding;\n// var pointRadius = 5;\n// var margin = hullPadding + pointRadius;\n\nvar vecScale = function (scale, v) {\n    // Returns the vector 'v' scaled by 'scale'.\n    return [ scale * v[0], scale * v[1] ];\n}\n\nvar vecSum = function (pv1, pv2) {\n    // Returns the sum of two vectors, or a combination of a point and a vector.\n    return [ pv1[0] + pv2[0], pv1[1] + pv2[1] ];\n}\n\nvar unitNormal = function (p0, p1) {\n    // Returns the unit normal to the line segment from p0 to p1.\n    var n = [ p0[1] - p1[1], p1[0] - p0[0] ];\n    var nLength = Math.sqrt (n[0]*n[0] + n[1]*n[1]);\n    return [ n[0] / nLength, n[1] / nLength ];\n};\n\nvar strictHull = function(polyPoints) {\n    // This method returns a polygon given the specified points. The points are assumed to be in polygon order.\n    return (\n        'M ' + polyPoints[0]\n        + ' L '\n        + d3.range(1,polyPoints.length)\n            .map(function(i) {return polyPoints[i];})\n            .join(' L')\n        + ' Z'\n    );\n};\n\nvar roundedHull = function (polyPoints, data) {\n    // Returns the SVG path data string representing the polygon, expanded and rounded.\n\n\t// console.log(polyPoints, data);\n\n\thullPadding = d3.max(data, function(d){\n\t\treturn d.opened ? r(1) + collisionPadding : r(d.totalSubNodes + 1) + collisionPadding;\n\t})\n\n    // Handle special cases\n    if (!polyPoints || polyPoints.length < 1) return \"\";\n    if (polyPoints.length === 1) return roundedHull1 (polyPoints, data);\n    if (polyPoints.length === 2) return roundedHull2 (polyPoints, data);\n\n    var segments = new Array (polyPoints.length);\n\n    // Calculate each offset (outwards) segment of the convex hull.\n    for (var segmentIndex = 0;  segmentIndex < segments.length;  ++segmentIndex) {\n        var p0 = (segmentIndex === 0) ? polyPoints[polyPoints.length-1] : polyPoints[segmentIndex-1];\n        var p1 = polyPoints[segmentIndex];\n\n        // Compute the offset vector for the line segment, with length = hullPadding.\n        var offset = vecScale (hullPadding, unitNormal (p0, p1));\n\n        segments[segmentIndex] = [ vecSum (p0, offset), vecSum (p1, offset) ];\n    }\n\n    var arcData = 'A ' + [hullPadding, hullPadding, '0,0,0,'].join(',');\n\n    segments = segments.map (function (segment, index) {\n        var pathFragment = \"\";\n        if (index === 0) {\n            var pathFragment = 'M ' + segments[segments.length-1][1] + ' ';\n        }\n        pathFragment += arcData + segment[0] + ' L ' + segment[1];\n\n        return pathFragment;\n    });\n\n    return segments.join(' ');\n}\n\nvar roundedHull1 = function (polyPoints, data) {\n    // Returns the path for a rounded hull around a single point (a circle).\n\n    var p1 = [polyPoints[0][0], polyPoints[0][1] - hullPadding];\n    var p2 = [polyPoints[0][0], polyPoints[0][1] + hullPadding];\n\n    return 'M ' + p1\n        + ' A ' + [hullPadding, hullPadding, '0,0,0', p2].join(',')\n        + ' A ' + [hullPadding, hullPadding, '0,0,0', p1].join(',');\n};\n\n\nvar roundedHull2 = function (polyPoints, data) {\n    // Returns the path for a rounded hull around two points (a \"capsule\" shape).\n\n    var offsetVector = vecScale (hullPadding, unitNormal (polyPoints[0], polyPoints[1]));\n    var invOffsetVector = vecScale (-1, offsetVector);\n\n    var p0 = vecSum (polyPoints[0], offsetVector);\n    var p1 = vecSum (polyPoints[1], offsetVector);\n    var p2 = vecSum (polyPoints[1], invOffsetVector);\n    var p3 = vecSum (polyPoints[0], invOffsetVector);\n\n    return 'M ' + p0\n        + ' L ' + p1 + ' A ' + [hullPadding, hullPadding, '0,0,0', p2].join(',')\n        + ' L ' + p3 + ' A ' + [hullPadding, hullPadding, '0,0,0', p0].join(',');\n};\n","import * as d3 from 'd3'\n\nconst ParseMatrixData = {}\n\nParseMatrixData.parser = (rawData) => {\n\n  rawData.forEach(function(d){ d.year = new Date(d.year); })\n\n  let data = rawData.map(function(d) {\n    d.year = new Date(d.year);\n    if(!d.id) { d.id = d['data.id'] }\n    var obj = {\n\t\t\t'id': d.id,\n\t\t\t'label': d['Occorrenza'],\n\t\t\t'part_of': d['Parte di ID'],\n\t\t\t'source': d['Fonte'],\n\t\t\t'sourceTitle': d['Titolo Fonte'],\n\t\t\t'year': +d.year,\n\t\t\t'category': d['Categoria'],\n\t\t\t'totalSubNodes':0,\n      'publicationType': d['Pubblicazione Fonte'],\n      'isGuessed': d['Luogo desunto'],\n      'themes': d['Tema']\n\t\t}\n\t\treturn obj\n\t})\n  data = ParseMatrixData.handleHierarchies(data)\n\n  const graph = ParseMatrixData.calculateNetwork(data);\n  // console.log(graph)\n  return graph;\n}\n\nParseMatrixData.handleHierarchies = (nodes) => {\n  let hierarchies = d3.nest()\n\t\t.key(function(d){ return d.part_of })\n\t\t.entries(nodes);\n\n\thierarchies\n\t\t.filter(function(d){ return d.key === '' })[0]\n\t\t.values.forEach(function(d){\n\t\t\tvar part_of_d = hierarchies.find(function(e){ return e.key === d.id })\n\t\t\tif (part_of_d) {\n\t\t\t\t// console.log('LVL 0',d.id, d.label, 'is parent of', part_of_d.values.length);\n\t\t\t\td.subNodes = part_of_d.values;\n\t\t\t\td.totalSubNodes = part_of_d.values.length\n\n\t\t\t\tpart_of_d.values.forEach(function(e){\n\t\t\t\t\tvar part_of_e = hierarchies.find(function(f){ return f.key === e.id })\n\t\t\t\t\tif (part_of_e) {\n\t\t\t\t\t\t// console.log('LVL 1',e.id, e.label, 'is parent of', part_of_e.values.length);\n\t\t\t\t\t\te.subNodes = part_of_e.values\n\t\t\t\t\t\te.totalSubNodes = part_of_e.values.length\n\t\t\t\t\t\td.totalSubNodes += e.totalSubNodes\n\n\t\t\t\t\t\tpart_of_e.values.forEach(function(f){\n\t\t\t\t\t\t\tvar part_of_f = hierarchies.find(function(g){ return g.key === f.id})\n\t\t\t\t\t\t\tif (part_of_f) {\n\t\t\t\t\t\t\t\t// console.log('LVL 2', f.id, f.label, 'is parent of', part_of_f.values.length)\n\t\t\t\t\t\t\t\tf.subNodes = part_of_f.values\n\t\t\t\t\t\t\t\tf.totalSubNodes = part_of_f.values.length\n\t\t\t\t\t\t\t\td.totalSubNodes += f.totalSubNodes\n\n\t\t\t\t\t\t\t\tpart_of_f.values.forEach(function(g){\n\t\t\t\t\t\t\t\t\tvar part_of_g = hierarchies.find(function(h){ return h.key === g.id })\n\t\t\t\t\t\t\t\t\tif (part_of_g) {\n\t\t\t\t\t\t\t\t\t\t// console.log('LVL 3', g.id, g.label, 'is parent of', part_of_g.values.length)\n\t\t\t\t\t\t\t\t\t\tg.subNodes = part_of_g.values\n\t\t\t\t\t\t\t\t\t\tg.totalSubNodes = part_of_g.values.length\n\t\t\t\t\t\t\t\t\t\td.totalSubNodes += f.totalSubNodes\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t// return array of hierarchical nodes\n\treturn hierarchies.filter(function(d){ return d.key === '' })[0].values;\n}\n\nParseMatrixData.calculateNetwork = (nodes) => {\n\t// create the array of edges\n\tvar edges = []\n\t// base edges on works co-occurrences of places\n\td3.nest()\n\t\t.key(function(d) { return d.source })\n\t\t.entries(nodes)\n\t\t.forEach((d) => {\n\t\t\td.values.filter(function(e) {\n\t\t\t\treturn e.part_of !== '';\n\t\t\t}).forEach((n, i) => {\n\t\t\t\tvar obj = {}\n\t\t\t\tobj = {\n\t\t\t\t\t'source': n.id,\n\t\t\t\t\t'target': n.part_of,\n\t\t\t\t\t'volume': d.key,\n\t\t\t\t\t// 'year': n.year,\n\t\t\t\t\t'source_part_of': n.part_of,\n\t\t\t\t\t'kind': 'part_of'\n\t\t\t\t}\n\t\t\t\tedges.push(obj);\n\t\t\t})\n\t\t})\n\treturn { 'nodes': nodes, 'edges': edges, 'root_nodes': nodes.filter(d => d.subNodes) }\n}\n\nexport default ParseMatrixData\n","import React, { Component } from 'react';\nimport './PlacesMatrix.css'\nimport V from './matrix.d3'\n\nclass PlacesMatrix extends Component {\n  componentDidMount() {\n    this._chart = V.initialize(\n        this._rootNode,\n        this.props.data,\n        this.props.filters\n    );\n  }\n\n  componentDidUpdate() {\n    V.update(\n       null,\n       this.props.filters\n    );\n  }\n\n  componentWillUnmount() {\n    V.destroy(this._rootNode);\n  }\n\n  _setRef(componentNode) {\n      this._rootNode = componentNode;\n  }\n\n\n  render() {\n    const style={\n      width: '100%',\n      height: '100%'\n    }\n    return <svg id={this.props.id} style={style} ref={this._setRef.bind(this)}></svg>\n  }\n}\n\nexport default PlacesMatrix;\n","import React, { Component } from 'react';\nimport HeaderViz from '../general/HeaderViz'\nimport BodyViz from '../general/BodyViz';\nimport MainMenu from '../general/MainMenu';\nimport * as d3 from 'd3';\n\nimport Loading from '../general/Loading';\nimport TimeFilter from '../visualizations/TimeFilter'\nimport DropDownSelect from '../general/DropDownSelect'\nimport SetOption from '../general/SetOption'\nimport PlacesMatrix from '../visualizations/PlacesMatrix';\n\nimport ParseMatrixData from './parse-matrix-data'\n\nclass PlacesMatrixView extends Component {\n\n  constructor(props){\n    super(props);\n    this.loadData = this.loadData.bind(this);\n    this.state = {\n      data:'data still not loaded',\n      isLoading: true,\n      openAll: false\n    };\n    this.changeSpan = this.changeSpan.bind(this);\n    this.changeThemes = this.changeThemes.bind(this);\n    this.changePublications = this.changePublications.bind(this);\n    this.openAll = this.openAll.bind(this);\n  }\n\n  loadData() {\n    d3.tsv('./places-matrix-data.tsv')\n      .then( data => {\n        const graph = ParseMatrixData.parser(data);\n        return graph;\n      })\n      .then(data=>{\n        this.setState({\n          data: data,\n          dataTimeFilter: d3.extent(data.nodes, d => d.year),\n          themes: [\"tutti\",\"fabbrica\",\"guerra\",\"mare\",\"metropoli\",\"natura ligure\",\"paesaggio urbano\",\"protagonista bambino\",\"viaggio\"],\n          publicationsTypes: ['tutti','raccolta','volume','altro'],\n          isLoading: false,\n          filters: {\n            update: true,\n            openAll: false\n          }\n        })\n      })\n  }\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  changeSpan(newSpan) {\n    this.setState({\n      span: newSpan,\n      filters: {\n        timeFilter:newSpan,\n        update: true\n      }\n    });\n  }\n\n  changeThemes(newThemes) {\n    this.setState({\n      filters: {\n        selectedThemes: newThemes,\n        update: false\n      }\n    });\n  }\n\n  changePublications(newPublications) {\n    this.setState({\n      filters: {\n        selectedPublications: newPublications,\n        update: false\n      }\n    });\n  }\n\n  openAll(value) {\n    this.setState({\n      filters: {\n        openAll: value,\n        update: true\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <HeaderViz>\n          <MainMenu style={{gridColumn: 'span 1'}}/>\n          <div  style={{gridColumn: 'span 2'}}/>\n          <SetOption style={{gridColumn: 'span 2', display: 'none'}} selected={this.openAll} title=\"Apri tutto\"/>\n\n          { this.state.isLoading && <Loading style={{gridColumn: 'span 6'}} /> }\n          { !this.state.isLoading && <TimeFilter style={{gridColumn: 'span 6'}} data={this.state.dataTimeFilter} changeSpan={this.changeSpan} title=\"Imposta un filtro temporale\"/> }\n\n          { this.state.isLoading && <Loading style={{gridColumn: 'span 4'}} /> }\n          { !this.state.isLoading && <DropDownSelect style={{gridColumn: 'span 4'}} options={this.state.publicationsTypes} changeOptions={this.changePublications} title=\"Tipo di pubblicazione\"/> }\n\n          { this.state.isLoading && <Loading style={{gridColumn: 'span 4'}} /> }\n          { !this.state.isLoading && <DropDownSelect style={{gridColumn: 'span 4'}} options={this.state.themes} changeOptions={this.changeThemes} title=\"Evidenzia un tema\"/> }\n\n          <div style={{gridColumn: 'span 6'}}>ricerca</div>\n          <div style={{gridColumn: 'span 1'}}>help</div>\n        </HeaderViz>\n\n        <BodyViz className=\"the-body-viz\">\n          { this.state.isLoading && <Loading /> }\n          { !this.state.isLoading && <PlacesMatrix data={this.state.data} filters={this.state.filters} /> }\n        </BodyViz>\n      </div>\n    );\n  }\n}\n\nexport default PlacesMatrixView;\n","import React from 'react';\nimport './App.css';\nimport PlacesMatrixView from './PlacesMatrixView/PlacesMatrixView';\n// import ContainerComp from './ContainerComp/ContainerComp';\n\nfunction App() {\n  return (\n      <PlacesMatrixView />\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}
{"version":3,"sources":["GlobalData.js","general/MainMenu/MainMenu.js","general/PageTitle/PageTitle.js","general/MoreInfo/MoreInfo.js","general/Bussola/Bussola.js","general/Loading/Loading.js","general/Options/Options.js","general/Search/Search.js","general/RangeFilter/range-filter.d3.js","general/RangeFilter/RangeFilter.js","utilities/parse-matrix-data.js","visualizations/PlacesMatrix/matrix.d3.js","visualizations/PlacesMatrix/PlacesMatrix.js","Trasformare/Trasformare.js","App.js","serviceWorker.js","index.js"],"names":["GlobalData","allVolumes","MainMenu","className","style","this","props","icon","faBars","Component","defaultProps","gridColumn","PageTitle","title","MoreInfo","faQuestionCircle","Bussola","faCompass","Loading","Options","state","show","undefined","selection","data","multiple","options","filter","d","status","label","handleChange","bind","toggleDropDown","reset","newOptions","slice","forEach","changeOptions","console","log","event","ee","name","target","getAttribute","setState","selected_item","length","isOpen","metadata","source","Dropdown","onToggle","Toggle","Menu","map","i","Item","key","onClick","Search","fontSize","position","top","onChange","selected","id","svg","context","gBrush","info","width","height","funcChangeSpan","margin","Viz","el","changeSpan","d3","select","right","bottom","node","getBoundingClientRect","parseFloat","getComputedStyle","document","documentElement","left","x","range","domain","brush","extent","handleSize","on","brushed","append","attr","classed","selectAll","call","move","span","exit","remove","enter","scale","getAnchor","text","getFullYear","merge","sourceEvent","type","invert","Date","update","RangeFilter","_chart","initialize","_rootNode","destroy","componentNode","ref","_setRef","ParseMatrixData","rawData","year","split","hierarchies","handleHierarchies","graph","calculateNetwork","nodes","part_of","entries","values","part_of_d","find","e","subNodes","totalSubNodes","part_of_e","f","part_of_f","g","part_of_g","h","edges","n","obj","push","originalData","globalTimeFilter","y","r","color","originalLabelsSize","xAxisCall","yAxisCall","g_forceLayout","xAxis","yAxis","hull","link","presumed","information","simulation","categories","categoriesColors","links","hullsData","last","V","_originalData","timeStamp","ticks","every","padding","tickSize","tickFormat","replace","exponent","step","size","nnn","closeSubnodes","toOpen","n0","category","indexOf","n1","n2","openSubnodes","toClose","nn","each","selectNode","unselectNode","force","thisCollisionPadding","collisionPadding","opened","strength","iterations","distance","points","convexHull","roundedHull","stop","zoom","translateExtent","scaleExtent","transform","new_x","rescaleX","newSize","k","l","timeFilter","fx","correspondingYear","toggleSubnodes","selectLabel","selectSameComposition","displayTitle","darker","isGuessed","kind","alpha","restart","selectLabelsArr","applyFilter","an_id","openOnSearch","arr","parents2open","s","search4Parent","nodeId","thisNode","od","reverse","parentId","parent_id","parent","openAll","runAll","nodesList","closeAll","doRestart","fy","subNode","thisHullNodes","concat","thisHull","augmentedNodes","subNodes2Remove","hulls2Remove","collectSubNodes","parentNode","childNode","toRemove","filtered","includes","unselectLabel","sourceTitle","doReset","hullPadding","vecScale","v","vecSum","pv1","pv2","unitNormal","p0","p1","nLength","Math","sqrt","polyPoints","roundedHull1","roundedHull2","segments","Array","segmentIndex","offset","arcData","join","segment","index","pathFragment","p2","offsetVector","invOffsetVector","p3","PlacesMatrix","prevProps","prevState","searched","selectThoseLabels","gruppi","Trasformare","changeCercaPer","changeRicerca","changeGruppi","changePubblicazioni","changeAmbienti","changeTimeSpan","downloadData","isLoading","cerca_per","then","parser","themes","flat","kinds","publicationType","environments","allTitles","pubVenueTitle","nodesByPublicationTitle","publishedHere","searchByCompositionTitle","dd","data_research","luogo","sort","a","b","localeCompare","titolo","time","noFilter","ricerca","toPreserveRicerca","pubblicazioni","toPreservePubblicazioni","volumi","toPreserveVolumi","ambienti","toPreserveAmbienti","timeExtent","error","research_options","toPreserve","_","flattenDeep","intersection","statoGruppi","criteria","value","selectedData","export_data","composition_id","composition_title","the_date","filename","file","Blob","window","navigator","msSaveOrOpenBlob","createElement","url","URL","createObjectURL","href","download","body","appendChild","click","setTimeout","removeChild","revokeObjectURL","loadData","addEventListener","removeEventListener","textAlign","App","Boolean","location","hostname","match","ReactDOM","render","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.d39a9ab7.chunk.js","sourcesContent":["const GlobalData = {\n  allVolumes: [\n    {\"id\":\"V001\",\"label\":\"Il sentiero dei nidi di ragno\"},\n    {\"id\":\"V002\",\"label\":\"Ultimo viene il corvo\"},\n    {\"id\":\"V003\",\"label\":\"Il visconte dimezzato\"},\n    {\"id\":\"V004\",\"label\":\"L'entrata in guerra\"},\n    {\"id\":\"V005\",\"label\":\"Il barone rampante\"},\n    {\"id\":\"V006\",\"label\":\"I racconti\"},\n    {\"id\":\"V007\",\"label\":\"La formica argentina\"},\n    {\"id\":\"V008\",\"label\":\"Il cavaliere inesistente\"},\n    {\"id\":\"V009\",\"label\":\"La giornata di uno scrutatore\"},\n    {\"id\":\"V010\",\"label\":\"La speculazione edilizia\"},\n    {\"id\":\"V011\",\"label\":\"Marcovaldo\"},\n    {\"id\":\"V012\",\"label\":\"La nuvola di smog e La formica argentina\"},\n    {\"id\":\"V013\",\"label\":\"Le cosmicomiche\"},\n    {\"id\":\"V014\",\"label\":\"Ti con Zero\"},\n    {\"id\":\"V015\",\"label\":\"La memoria del mondo\"},\n    {\"id\":\"V016\",\"label\":\"Il castello dei destini incrociati\"},\n    {\"id\":\"V017\",\"label\":\"Gli amori difficili\"},\n    {\"id\":\"V018\",\"label\":\"Le città invisibili\"},\n    {\"id\":\"V019\",\"label\":\"Il castello dei destini incrociati (riediz)\"},\n    {\"id\":\"V020\",\"label\":\"Eremita a Parigi\"},\n    {\"id\":\"V021\",\"label\":\"Se una notte d'inverno un viaggiatore\"},\n    {\"id\":\"V022\",\"label\":\"Palomar\"},\n    {\"id\":\"V023\",\"label\":\"Le cosmicomiche vecchie e nuove\"}\n  ]\n}\n\nexport default GlobalData\n","import React, { Component } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBars } from '@fortawesome/free-solid-svg-icons';\nimport './MainMenu.css';\n\nclass MainMenu extends Component {\n  render() {\n    return <div className=\"main-menu\" style={this.props.style}><FontAwesomeIcon icon={faBars} /></div>;\n  }\n}\n\nexport default MainMenu;\n\nMainMenu.defaultProps = { style: {gridColumn: 'span 1'}}\n","import React, { Component } from 'react';\n\nclass PageTitle extends Component {\n  render() {\n    return <div className=\"page-title\" style={this.props.style}>{this.props.title}</div>;\n  }\n}\n\nexport default PageTitle;\n\nPageTitle.defaultProps = {\n  title: 'This page needs a title',\n  style: {gridColumn: 'span 12'}\n};\n","import React, { Component } from 'react';\nimport './MoreInfo.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faQuestionCircle } from '@fortawesome/free-regular-svg-icons';\n\nclass MoreInfo extends Component {\n  render() {\n    return <div style={this.props.style} className=\"more-info\"><FontAwesomeIcon icon={faQuestionCircle} /></div>;\n  }\n}\n\nexport default MoreInfo;\n","import React, { Component } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCompass } from '@fortawesome/free-regular-svg-icons';\n\nclass Bussola extends Component {\n  render() {\n    return <div style={this.props.style} className=\"more-info\"><FontAwesomeIcon icon={faCompass} /></div>;\n  }\n}\n\nexport default Bussola;\n","import React, { Component } from 'react';\n\nclass Loading extends Component {\n  render() {\n    return <div style={this.props.style}>Loading ...</div>;\n  }\n}\n\nexport default Loading;\n","import React, { Component } from 'react';\nimport './Options.css'\n\nimport Dropdown from 'react-bootstrap/Dropdown'\n\nclass Options extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      show:undefined,\n      selection: (this.props.data.multiple===false) ? this.props.data.options.filter(d=>d.status)[0].label : undefined\n    }\n    this.handleChange = this.handleChange.bind(this);\n    this.toggleDropDown = this.toggleDropDown.bind(this);\n  }\n\n  componentDidMount() {\n    // console.log('Mounted',this.props.title, this.props.data);\n  }\n\n  componentDidUpdate() {\n    // console.log('Update',this.props.title)\n    if (this.props.data.reset) {\n      let newOptions = this.props.data.options.slice(0)\n      newOptions.forEach(d=>d.status=false)\n      if (this.props.changeOptions){\n        this.props.changeOptions(newOptions)\n      } else {\n        console.log('No function')\n      }\n    }\n  }\n\n  handleChange(event,ee) {\n    const name = event.target.getAttribute('name');\n\n    // A convenient way to clone an array, since it is a bad thing to directly modify the props\n    let newOptions = this.props.data.options.slice(0)\n\n    if (!this.props.data.multiple) {\n      newOptions.forEach(d=>d.status=false)\n      this.setState({\n        selection:name\n      })\n    }\n\n    // If \"all\" is selected, invert the selection, then return\n    if (name===\"all\"){\n      newOptions.forEach(d=>d.status=!d.status);\n    } else {\n      const selected_item = newOptions.filter(d=>d.label===name)\n      if (selected_item.length>0) {\n        selected_item[0].status = !selected_item[0].status\n      }\n    }\n\n    if (this.props.changeOptions){\n      this.props.changeOptions(newOptions)\n    } else {\n      console.log('No function')\n    }\n\n  }\n\n  toggleDropDown(isOpen,event,metadata) {\n    if (metadata.source===\"select\"&&this.props.data.multiple){\n      this.setState({\n        show: true\n      })\n    } else {\n      this.setState({\n        show: undefined\n      })\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"options-container\" style={this.props.style}>\n\n        <Dropdown onToggle={this.toggleDropDown} show={this.state.show}>\n          <Dropdown.Toggle>\n            { !this.props.data.multiple && (\n                <div>\n                  <span className=\"micro-title\">{this.props.title}</span>\n                  <span className=\"current-selection\">{this.state.selection}</span>\n                </div>\n              )\n            }\n            { this.props.data.multiple && this.props.title }\n          </Dropdown.Toggle>\n          <Dropdown.Menu onToggle={this.toggleDropDown} show={this.state.show}>\n            {\n              this.props.data.options.map( (d,i) => {\n                return (\n                  <Dropdown.Item key={i} name={d.label} onClick={this.handleChange} className={{'active':d.status}}>\n                    {d.label}\n                  </Dropdown.Item>\n                )\n              })\n            }\n            { this.props.data.multiple && (\n              <Dropdown.Item key={5} name=\"all\" onClick={this.handleChange} className={{'active':false}}>\n                Inverti Selezione\n              </Dropdown.Item>\n            ) }\n          </Dropdown.Menu>\n        </Dropdown>\n\n      </div>\n    )\n  }\n}\n\nexport default Options;\n\nOptions.defaultProps = {\n  style: {\n    gridColumn: 'span 4'\n  },\n  data: {\n    options: [],\n    multiple: false\n  },\n  title: 'Options',\n\n}\n","import React, { Component } from 'react';\nimport './Search.css';\nimport {Typeahead} from 'react-bootstrap-typeahead';\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\nimport 'react-bootstrap-typeahead/css/Typeahead-bs4.css';\n\nclass Search extends Component {\n  render() {\n    let isSelection = false;\n    return <div className=\"search-component\" style={this.props.style}>\n      { !isSelection && <span style={\n          {fontSize: '1rem',\n          position: 'relative',\n          top: '-3px'}\n      }>/</span>}\n      <Typeahead\n        multiple\n        onChange={(selected) => {\n\n          // const filtered_data = { ...this.props.data }\n          //\n          // filtered_data.options\n          //   .map(d=>{\n          //     d.status = (selected.length>0) ? selected.map(s=>s.label).indexOf(d.label) > -1 : true\n          //     return d\n          //   })\n\n          if (selected.length > 0) {\n            this.props.changeOptions(selected)\n          } else {\n            this.props.changeOptions(this.props.data.options)\n          }\n\n        }}\n        options={this.props.data.options}\n        id=\"main-search\"\n      />\n\n    </div>;\n  }\n}\n\nexport default Search;\n\nSearch.defaultProps = {\n  style: {\n    gridColumn: 'span 4'\n  }\n}\n","import * as d3 from 'd3';\n\nlet svg, context, gBrush, info, width, height, margin = {},\n\tfuncChangeSpan;\n\nconst Viz = {};\n\nViz.initialize = (el, data, changeSpan) => {\n\t// console.log('initialized')\n\n\t// data must be an array with 2+ elements. Element is a Date object\n\n\t// Important to declare at beginning\n\tfuncChangeSpan = changeSpan;\n\n\t// console.log(el.getBoundingClientRect().width)\n\t//\n\n\tsvg = d3.select(el).select('svg')\n\n\tfunction convertRemToPixels(rem) {\n\t\treturn rem * parseFloat(getComputedStyle(document.documentElement).fontSize);\n\t}\n\n\t//1.2857142857rem\n\n\tconst m = 10;\n\tmargin.top = m\n\tmargin.right = m\n\tmargin.bottom = svg.node().getBoundingClientRect().height - convertRemToPixels(1.2857142857) - margin.top\n\tmargin.bottom = margin.top\n\tmargin.left = m\n\n\twidth = svg.node().getBoundingClientRect().width - margin.left - margin.right;\n\theight = svg.node().getBoundingClientRect().height - margin.top - margin.bottom;\n\n\tViz.x = d3.scaleTime()\n\t\t.range([0, width])\n\t\t.domain(d3.extent(data, d => d));\n\n\tViz.brush = d3.brushX()\n\t\t.extent([\n\t\t\t[0, 0],\n\t\t\t[width, height]\n\t\t])\n\t\t.handleSize(m)\n\t\t.on(\"brush end\", brushed)\n\n  gBrush = svg.append(\"g\")\n\t\t.attr(\"class\", \"brush\")\n    .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\n\tcontext = svg.append(\"g\")\n\t\t.attr(\"class\", \"context\")\n\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n    .style(\"pointer-events\", \"none\")\n\n\tcontext.append('rect')\n\t\t.classed(\"context-window\", true)\n\t\t.attr(\"width\", width)\n\t\t.attr(\"height\", height)\n\n  // important before brushed is called or assigned\n  info = context.append('g').selectAll('.info')\n\n\n\tgBrush.call(Viz.brush)\n\t\t.call(Viz.brush.move, Viz.x.range())\n\n}\n\nViz.update = (span) => {\n\t// console.log('updated')\n\n\tinfo = info.data(span, d => d);\n\tinfo.exit().remove()\n\tinfo = info.enter().append('text')\n\t\t.attr('class', 'info')\n\t\t.attr('x', d => { return Viz.x(d) })\n\t\t.attr('y', height-1.9) // this value depends on the font-size\n\t\t.attr('text-anchor', (d, i) => {\n\t\t\tfunction getAnchor(d, scale, width) {\n\t\t\t\tlet anchor;\n\t\t\t\tif(i % 2 === 0) {\n\t\t\t\t\tif(scale(d) >= width / 4) {\n\t\t\t\t\t\tanchor = 'end';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tanchor = 'start';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(scale(d) <= width / 4 * 3) {\n\t\t\t\t\t\tanchor = 'start';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tanchor = 'end';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn anchor;\n\t\t\t}\n\t\t\treturn getAnchor(d, Viz.x, width);\n\t\t})\n\t\t.text(d => {\n\t\t\treturn d.getFullYear()\n\t\t})\n\t\t.merge(info)\n\n}\n\nViz.destroy = (el) => {}\n\nexport default Viz\n\nfunction brushed() {\n\tif(d3.event.sourceEvent && d3.event.sourceEvent.type === \"zoom\") return; // ignore brush-by-zoom\n\tif(d3.event.selection) {\n\t\tvar span = d3.event.selection || Viz.x.range();\n\t\tspan = span.map(d => { return Viz.x.invert(d) })\n\t\tif(d3.event.type === \"end\") {\n\t\t\tconsole.log('filtered by time')\n\t\t\tfuncChangeSpan(span);\n\t\t}\n\t\tspan = span.map(d => new Date(d));\n\t\tViz.update(span);\n\t}\n}\n","import React, { Component } from 'react';\nimport './RangeFilter.css';\n\nimport Viz from './range-filter.d3'\n\nclass RangeFilter extends Component {\n\n  componentDidMount() {\n    this._chart = Viz.initialize(this._rootNode, this.props.data, this.props.changeOptions);\n  }\n\n  componentDidUpdate() {\n  }\n\n  componentWillUnmount() {\n    Viz.destroy(this._rootNode);\n  }\n\n  _setRef(componentNode) {\n      this._rootNode = componentNode;\n  }\n\n  render() {\n    // console.log(this.props.data)\n    return <div style={this.props.style} ref={this._setRef.bind(this)}><svg className=\"range-filter\"></svg></div>;\n  }\n}\n\nexport default RangeFilter;\n\n// RangeFilter.defaultProps = {\n//   title: 'Time Filter',\n//   style: {\n//     gridColumn: 'span 4'\n//   }\n// }\n","import * as d3 from 'd3'\n\nconst ParseMatrixData = {}\n\nParseMatrixData.parser = (rawData) => {\n\n  rawData.forEach(function(d){ d.year = new Date(d.year); })\n\n  let data = rawData.map(function(d) {\n    d.year = new Date(d.year);\n    if(!d.id) { d.id = d['data.id'] }\n    var obj = {\n\t\t\t'id': d.id,\n\t\t\t'label': d['Occorrenza'],\n\t\t\t'part_of': d['Parte di ID'],\n\t\t\t'source': d['Fonte'],\n\t\t\t'sourceTitle': d['Titolo Fonte'],\n\t\t\t'year': +d.year,\n\t\t\t'category': d['Categoria'],\n\t\t\t'totalSubNodes':0,\n      'publicationType': d['Pubblicazione Fonte'].split(';'),\n      'pubVenueTitle': d['Pubblicazioni Titoli'],\n      'isGuessed': d['Luogo desunto'],\n      'themes': d['Tema'].split(';')\n\t\t}\n\t\treturn obj\n\t})\n\n  const hierarchies = ParseMatrixData.handleHierarchies(data)\n\n  const graph = ParseMatrixData.calculateNetwork(hierarchies);\n  return {graph,data};\n}\n\nParseMatrixData.handleHierarchies = (nodes) => {\n  let hierarchies = d3.nest()\n\t\t.key(function(d){ return d.part_of })\n\t\t.entries(nodes);\n\n\thierarchies\n\t\t.filter(function(d){ return d.key === '' })[0]\n\t\t.values.forEach(function(d){\n\t\t\tvar part_of_d = hierarchies.find(function(e){ return e.key === d.id })\n\t\t\tif (part_of_d) {\n\t\t\t\t// console.log('LVL 0',d.id, d.label, 'is parent of', part_of_d.values.length);\n\t\t\t\td.subNodes = part_of_d.values;\n\t\t\t\td.totalSubNodes = part_of_d.values.length\n\n\t\t\t\tpart_of_d.values.forEach(function(e){\n\t\t\t\t\tvar part_of_e = hierarchies.find(function(f){ return f.key === e.id })\n\t\t\t\t\tif (part_of_e) {\n\t\t\t\t\t\t// console.log('LVL 1',e.id, e.label, 'is parent of', part_of_e.values.length);\n\t\t\t\t\t\te.subNodes = part_of_e.values\n\t\t\t\t\t\te.totalSubNodes = part_of_e.values.length\n\t\t\t\t\t\td.totalSubNodes += e.totalSubNodes\n\n\t\t\t\t\t\tpart_of_e.values.forEach(function(f){\n\t\t\t\t\t\t\tvar part_of_f = hierarchies.find(function(g){ return g.key === f.id})\n\t\t\t\t\t\t\tif (part_of_f) {\n\t\t\t\t\t\t\t\t// console.log('LVL 2', f.id, f.label, 'is parent of', part_of_f.values.length)\n\t\t\t\t\t\t\t\tf.subNodes = part_of_f.values\n\t\t\t\t\t\t\t\tf.totalSubNodes = part_of_f.values.length\n\t\t\t\t\t\t\t\td.totalSubNodes += f.totalSubNodes\n\n\t\t\t\t\t\t\t\tpart_of_f.values.forEach(function(g){\n\t\t\t\t\t\t\t\t\tvar part_of_g = hierarchies.find(function(h){ return h.key === g.id })\n\t\t\t\t\t\t\t\t\tif (part_of_g) {\n\t\t\t\t\t\t\t\t\t\t// console.log('LVL 3', g.id, g.label, 'is parent of', part_of_g.values.length)\n\t\t\t\t\t\t\t\t\t\tg.subNodes = part_of_g.values\n\t\t\t\t\t\t\t\t\t\tg.totalSubNodes = part_of_g.values.length\n\t\t\t\t\t\t\t\t\t\td.totalSubNodes += f.totalSubNodes\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t// return array of hierarchical nodes\n\treturn hierarchies.filter(function(d){ return d.key === '' })[0].values;\n}\n\nParseMatrixData.calculateNetwork = (nodes) => {\n\t// create the array of edges\n\tvar edges = []\n\t// base edges on works co-occurrences of places\n\td3.nest()\n\t\t.key(function(d) { return d.source })\n\t\t.entries(nodes)\n\t\t.forEach((d) => {\n\t\t\td.values.filter(function(e) {\n\t\t\t\treturn e.part_of !== '';\n\t\t\t}).forEach((n, i) => {\n\t\t\t\tvar obj = {}\n\t\t\t\tobj = {\n\t\t\t\t\t'source': n.id,\n\t\t\t\t\t'target': n.part_of,\n\t\t\t\t\t'volume': d.key,\n\t\t\t\t\t// 'year': n.year,\n\t\t\t\t\t'source_part_of': n.part_of,\n\t\t\t\t\t'kind': 'part_of'\n\t\t\t\t}\n\t\t\t\tedges.push(obj);\n\t\t\t})\n\t\t})\n\treturn { 'nodes': nodes, 'edges': edges, 'root_nodes': nodes.filter(d => d.subNodes)}\n}\n\nexport default ParseMatrixData\n","import * as d3 from 'd3';\nimport ParseMatrixData from '../../utilities/parse-matrix-data';\nimport _ from 'lodash';\n\nconst categories = ['generico_non_terrestre', 'nominato_non_terrestre', 'nominato_terrestre', 'generico_terrestre', 'inventato', 'no_ambientazione'];\nconst categoriesColors = ['#3131ff', '#bbbbff', '#ffce00', '#ff6c39', '#00c19c', '#cecece']\n\nconst collisionPadding = 0.25;\n\n// data\nlet originalData, graph, nodes = [],\n\tlinks = [],\n\thullsData = [],\n\tlast = 0,\n\tglobalTimeFilter;\n\n// Dimensions and scales\nlet x, y, r, color, margin = { 'top': 0, 'right': 50, 'bottom': 30, 'left': 50 },\n\toriginalLabelsSize,\n\twidth, height;\nlet xAxisCall, yAxisCall;\n\n// elements\nlet svg, g, g_forceLayout, xAxis, yAxis, hull, link, node, presumed, label, information\n\n// force-layout\nlet simulation\n\nconst V = {}\n\nexport default V\n\nV.initialize = (el, data, _originalData) => {\n\t// console.log('init');\n\t// console.log('data:', data);\n\t// console.log('filters:', filters);\n\n\toriginalData = _originalData;\n\n\t// Root element and dimensions\n\tsvg = d3.select(el).style('touch-action', 'manipulation');\n\twidth = svg.node().getBoundingClientRect().width - margin.left - margin.right;\n\theight = svg.node().getBoundingClientRect().height - margin.top - margin.bottom;\n\n\tsvg.append('rect')\n\t\t.attr('width', width + margin.left + margin.right)\n\t\t.attr('height', height + margin.top + margin.bottom)\n\t\t.classed('reset-rect', true)\n\t\t.on('click', d => {\n\t\t\tif((d3.event.timeStamp - last) < 500) {\n\t\t\t\tconsole.log('reset')\n\t\t\t\treset();\n\t\t\t}\n\t\t\tlast = d3.event.timeStamp;\n\t\t})\n\n\t// Scales\n\tx = d3.scaleTime()\n\t\t.range([0, width])\n\t\t.domain(d3.extent(data.nodes, d => d.year));\n\n\txAxisCall = d3.axisBottom(x).ticks(d3.timeYear.every(1));\n\n\ty = d3.scalePoint()\n\t\t.range([0, height])\n\t\t.domain(categories)\n\t\t.padding(0.5);\n\n\tyAxisCall = d3.axisRight(y)\n\t\t.tickSize(width)\n\t\t.tickFormat(d => {\n\t\t\treturn d.replace(/_/g, ' ')\n\t\t});\n\n\tr = d3.scalePow().exponent(0.5)\n\t\t.range([3, 25])\n\t\t.domain([1, d3.max(data.nodes, function(d) { return d.totalSubNodes })]);\n\n\tcolor = d3.scaleOrdinal().domain(categories).range(categoriesColors);\n\n\t// Groups and scales\n\tg = svg.append('g').attr(\"transform\", `translate(${margin.left},${margin.top})`);\n\txAxis = g.append(\"g\").attr(\"class\", \"x-axis\");\n\tyAxis = g.append('g').attr(\"class\", \"y-axis\");\n\tg_forceLayout = g.append('g');\n\n\txAxis.attr(\"transform\", `translate(${0}, ${height})`).call(xAxisCall);\n\n\tyAxis.attr(\"transform\", `translate(0, 0)`)\n\t\t.call(yAxisCall)\n\t\t.call(g => g.selectAll(\".tick text\")\n\t\t\t.style(\"text-transform\", \"capitalize\"))\n\t\t.call(g => g.select(\".domain\")\n\t\t\t.remove())\n\t\t.call(g => g.selectAll(\".tick line\")\n\t\t\t.attr(\"stroke-opacity\", 0.5)\n\t\t\t.attr(\"stroke-dasharray\", \"2,2\"))\n\t\t.call(g => g.selectAll(\".tick text\")\n\t\t\t.attr(\"x\", 4)\n\t\t\t.attr(\"dy\", -y.step() / 10));\n\n\tyAxis.selectAll('.tick')\n\t\t.on('click', function(d) {\n\n\t\t\tif(d3.select(this).classed('cat-selected') === false) {\n\n\t\t\t\tif(d3.selectAll('.tick.cat-selected').size() > 0) {\n\t\t\t\t\tnodes.filter(nnn => nnn.part_of === '').forEach(n => { closeSubnodes(n, false) });\n\t\t\t\t\td3.selectAll('.tick')\n\t\t\t\t\t\t.classed('cat-selected', false)\n\t\t\t\t\t\t.select('rect')\n\t\t\t\t\t\t.attr('fill', 'transparent')\n\t\t\t\t}\n\n\t\t\t\tlet toOpen = []\n\t\t\t\tnodes.forEach(n0 => {\n\t\t\t\t\t// console.log('n0',n0);\n\t\t\t\t\tif(n0.totalSubNodes > 0) {\n\t\t\t\t\t\tif(n0.subNodes.map(n => n.category).indexOf(d) > -1) {\n\t\t\t\t\t\t\ttoOpen.push(n0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tn0.subNodes.forEach(n1 => {\n\t\t\t\t\t\t\t// console.log('n1',n1);\n\t\t\t\t\t\t\tif(n1.totalSubNodes > 0) {\n\t\t\t\t\t\t\t\tif(n1.subNodes.map(n => n.category).indexOf(d) > -1) {\n\t\t\t\t\t\t\t\t\ttoOpen.push(n0);\n\t\t\t\t\t\t\t\t\ttoOpen.push(n1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tn1.subNodes.forEach(n2 => {\n\t\t\t\t\t\t\t\t\t// console.log('n2',n2);\n\t\t\t\t\t\t\t\t\tif(n2.totalSubNodes > 0) {\n\t\t\t\t\t\t\t\t\t\tif(n2.subNodes.map(n => n.category).indexOf(d) > -1) {\n\t\t\t\t\t\t\t\t\t\t\ttoOpen.push(n0);\n\t\t\t\t\t\t\t\t\t\t\ttoOpen.push(n1);\n\t\t\t\t\t\t\t\t\t\t\ttoOpen.push(n2);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\ttoOpen.forEach(n => { openSubnodes(n, false) });\n\n\t\t\t\td3.select(this).select('rect')\n\t\t\t\t\t.attr('fill', d => color(d))\n\t\t\t} else {\n\t\t\t\tlet toClose = []\n\t\t\t\tnodes.forEach(n0 => {\n\t\t\t\t\t// console.log('n0',n0);\n\t\t\t\t\tif(n0.totalSubNodes > 0) {\n\t\t\t\t\t\tif(n0.subNodes.map(n => n.category).indexOf(d) > -1) {\n\t\t\t\t\t\t\ttoClose.push(n0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tn0.subNodes.forEach(n1 => {\n\t\t\t\t\t\t\t// console.log('n1',n1);\n\t\t\t\t\t\t\tif(n1.totalSubNodes > 0) {\n\t\t\t\t\t\t\t\tif(n1.subNodes.map(n => n.category).indexOf(d) > -1) {\n\t\t\t\t\t\t\t\t\ttoClose.push(n0);\n\t\t\t\t\t\t\t\t\ttoClose.push(n1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tn1.subNodes.forEach(n2 => {\n\t\t\t\t\t\t\t\t\t// console.log('n2',n2);\n\t\t\t\t\t\t\t\t\tif(n2.totalSubNodes > 0) {\n\t\t\t\t\t\t\t\t\t\tif(n2.subNodes.map(n => n.category).indexOf(d) > -1) {\n\t\t\t\t\t\t\t\t\t\t\ttoClose.push(n0);\n\t\t\t\t\t\t\t\t\t\t\ttoClose.push(n1);\n\t\t\t\t\t\t\t\t\t\t\ttoClose.push(n2);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\ttoClose.forEach(n => { closeSubnodes(n, false) });\n\n\t\t\t\td3.select(this).select('rect')\n\t\t\t\t\t.attr('fill', 'transparent')\n\t\t\t}\n\t\t\tV.update();\n\n\t\t\tif(d3.select(this).classed('cat-selected') === false) {\n\t\t\t\tnode.filter(nn => { return nn.category === d }).each(nn => selectNode(nn))\n\t\t\t} else {\n\t\t\t\tnode.each(nn => unselectNode(nn))\n\t\t\t}\n\n\t\t\t// Now that everything is done, assign the class\n\t\t\td3.select(this).classed('cat-selected', !d3.select(this).classed('cat-selected'))\n\t\t})\n\t\t.append('rect')\n\t\t.attr('width', '14px')\n\t\t.attr('height', '14px')\n\t\t.attr('x', -14)\n\t\t.attr('y', -22)\n\t\t.attr('rx', 2)\n\t\t.attr('fill', 'transparent')\n\t\t.attr('stroke', d => color(d))\n\n\tlink = g_forceLayout.append('g').classed('links', true).selectAll('.link');\n\thull = g_forceLayout.append('g').classed('hulls', true).selectAll('.hull');\n\tnode = g_forceLayout.append('g').classed('nodes', true).selectAll('.node');\n\tpresumed = g_forceLayout.append('g').classed('presumed', true).selectAll('.presumed');\n\tlabel = g_forceLayout.append('g').classed('labels', true).selectAll('.label');\n\tinformation = g.append('g').classed('informations', true).selectAll('.information');\n\n\tsimulation = d3.forceSimulation(nodes)\n\t\t.force(\"collision\", d3.forceCollide(function(d) {\n\t\t\tlet thisCollisionPadding = d.totalSubNodes > 0 ? collisionPadding + 2 : collisionPadding;\n\t\t\treturn d.opened ? r(1) + thisCollisionPadding : r(d.totalSubNodes + 1) + thisCollisionPadding\n\t\t}).strength(.3).iterations(12))\n\t\t.force(\"link\", d3.forceLink()\n\t\t\t.strength(.45)\n\t\t\t.distance(r.range()[0])\n\t\t\t.id(function(d) { return d.id; })\n\t\t)\n\t\t.force(\"x\", d3.forceX(d => x(d.year)))\n\t\t.force(\"y\", d3.forceY(d => y(d.category)).strength(d => d.part_of === '' ? 0.1 : 0))\n\t\t.on(\"tick\", ticked)\n\t\t.on(\"end\", () => { console.log('simulation ended') })\n\t\t.stop()\n\n\tfunction ticked() {\n\t\tnode.attr(\"cx\", (d, i) => d.x)\n\t\t\t.attr(\"cy\", d => d.y);\n\n\t\tpresumed.attr(\"cx\", function(d) { return d.x; })\n\t\t\t.attr(\"cy\", function(d) { return d.y; });\n\n\t\tlabel.attr(\"x\", function(d) { return d.x; })\n\t\t\t.attr(\"y\", function(d) { return d.y; });\n\n\t\tlink.attr(\"x1\", function(d) { return d.source.x; })\n\t\t\t.attr(\"y1\", function(d) { return d.source.y; })\n\t\t\t.attr(\"x2\", function(d) { return d.target.x; })\n\t\t\t.attr(\"y2\", function(d) { return d.target.y; });\n\n\t\thull.attr(\"d\", function(d) {\n\t\t\tlet thisHullPoints = d.map(d => { return [d.x, d.y] });\n\t\t\tvar points = thisHullPoints;\n\t\t\tvar convexHull = (points.length < 3) ? points : d3.polygonHull(points);\n\t\t\treturn roundedHull(convexHull, d);\n\t\t})\n\t}\n\n\t// handle the zoom function\n\n\tlet zoom = d3.zoom()\n\t\t.translateExtent([\n\t\t\t[0, 0],\n\t\t\t[width + margin.left + margin.right, height + margin.top + margin.bottom]\n\t\t])\n\t\t.scaleExtent([1, 10])\n\t\t.on(\"zoom\", zoomed);\n\n\tfunction zoomed() {\n\t\t// so a simple resize+translate for the main group and the y axis\n\t\tg_forceLayout.attr(\"transform\", d3.event.transform);\n\t\tyAxis.attr(\"transform\", d3.event.transform);\n\n\t\t// the x axis has to be resscaled according to the zoom\n\t\t// taken from: https://bl.ocks.org/rutgerhofste/5bd5b06f7817f0ff3ba1daa64dee629d\n\t\tlet new_x = d3.event.transform.rescaleX(x);\n\t\txAxis.call(xAxisCall.scale(new_x))\n\n\t\t// rescale labels\n\t\tif(!originalLabelsSize) {\n\t\t\toriginalLabelsSize = d3.select('.label').style('font-size');\n\t\t\toriginalLabelsSize = parseFloat(originalLabelsSize);\n\t\t}\n\t\tconst newSize = originalLabelsSize / d3.event.transform.k\n\t\t// change style on the parent\n\t\t// this will propagate the new size to all children (label)\n\t\td3.select('g.labels').style('font-size', newSize + 'px')\n\n\t\t// display all labels of selected compositions\n\t\tif(d3.event.transform.k > 3) {\n\t\t\td3.selectAll('.node.selected').each(d => {\n\t\t\t\tlabel.filter(l => l.id === d.id).classed('zoom-selected', true)\n\t\t\t})\n\t\t} else {\n\t\t\tlabel.classed('zoom-selected', false)\n\t\t}\n\n\t\tinformation.attr('x', d => (new_x(d.year) >= width / 2) ? new_x(d.year) + 4.8 : new_x(d.year) - 3.2);\n\t}\n\n\tsvg.call(zoom).on(\"dblclick.zoom\", null);\n\n\t//Store data in global variable\n\tgraph = data;\n\t// globalTimeFilter = filter;\n\n\t// Precalculating the position of nodes allows to make them appear in place\n\tgraph.nodes = graph.nodes.map(d => {\n\t\treturn {\n\t\t\t...d,\n\t\t\tx: x(d.year),\n\t\t\ty: y(d.category)\n\t\t}\n\t})\n\n}\n\nV.update = (timeFilter) => {\n\t// console.log('update');\n\t// console.log('graph:', graph);\n\tif (timeFilter) {\n\t\tglobalTimeFilter = timeFilter\n\t} else {\n\t\ttimeFilter = globalTimeFilter\n\t}\n\n\t// update data\n\tnodes = graph.nodes;\n\tlinks = graph.edges;\n\n\t// update fx before updating the x scale\n\tnodes.forEach(d => {\n\t\tif(d.fx) {\n\t\t\td.correspondingYear = x.invert(d.fx)\n\t\t} else {\n\t\t\tdelete d.correspondingYear;\n\t\t}\n\t})\n\n\t// Update x domain\n\tx.domain(timeFilter)\n\txAxis.call(xAxisCall);\n\n\t// calculate new fx\n\tnodes.forEach(d => {\n\t\tif(d.correspondingYear) {\n\t\t\td.fx = x(d.correspondingYear)\n\t\t}\n\t})\n\n\tnode = node.data(nodes, d => { return d.id })\n\tnode.exit().remove();\n\tnode = node.enter().append('circle')\n\t\t.attr('class', d => `node`)\n\t\t.classed('sub-node', d => d.part_of !== '')\n\t\t// .classed('selected', d => d.isSelected )\n\t\t.attr('key', d => d.id)\n\t\t.on('mouseenter', d => {\n\t\t\tlabel.filter(l => l.id === d.id).style('display', 'block')\n\t\t\tnode.style('opacity', .25).filter(n => n.source === d.source).style('opacity', 1)\n\t\t})\n\t\t.on('mouseleave', d => {\n\t\t\tlabel.filter(l => l.id === d.id).style('display', 'none')\n\t\t\tnode.style('opacity', '')\n\t\t})\n\t\t.on('click', d => {\n\t\t\t// console.log('clicked on', d)\n\t\t\t// if double click/tap\n\t\t\tif((d3.event.timeStamp - last) < 500) {\n\t\t\t\ttoggleSubnodes(d, 'restart the force');\n\t\t\t}\n\t\t\tlast = d3.event.timeStamp;\n\t\t\t// do this after the nodes have been opened\n\t\t\tselectLabel(d);\n\t\t\tselectSameComposition(d);\n\t\t\tdisplayTitle([d]);\n\t\t})\n\t\t.merge(node)\n\t\t.style('cursor', function(d) { return d.subNodes && d.subNodes.length ? 'pointer' : 'auto'; })\n\t\t.attr(\"fill\", d => d.opened === true ? 'white' : color(d.category))\n\t\t.attr('stroke', function(d) { if(d.totalSubNodes > 0) return d3.color(color(d.category)).darker(1) })\n\t\t.attr(\"r\", function(d) { return d.opened ? r(1) : r(d.totalSubNodes + 1) }) // +1 means plus itself\n\n\tpresumed = presumed.data(nodes.filter(d => d.isGuessed), d => d.id)\n\tpresumed.exit().remove();\n\tpresumed = presumed.enter().append('circle')\n\t\t.classed('presumed', true)\n\t\t.attr('r', 1.5)\n\t\t.attr('fill', d => d3.color(color(d.category)).darker(1))\n\t\t.merge(presumed)\n\n\t// Apply the general update pattern to the links.\n\tlink = link.data(links, d => d.source.id + \"-\" + d.target.id);\n\tlink.exit().remove();\n\tlink = link.enter().append(\"line\")\n\t\t.classed('link', true)\n\t\t.classed('part-of', function(d) { return d.kind === 'part_of' })\n\t\t.attr('stroke-width', 0.5)\n\t\t.attr('stroke', '#ccc')\n\t\t.merge(link);\n\n\t// Apply the general update pattern to the labels.\n\tlabel = label.data(nodes, d => d.id);\n\tlabel.exit().remove();\n\tlabel = label.enter().append(\"text\")\n\t\t.classed('label', true)\n\t\t.style('display', 'none')\n\t\t.attr('text-anchor', 'middle')\n\t\t.style('pointer-events', 'none')\n\t\t.text(d => d.label)\n\t\t.merge(label);\n\n\t// Apply the general update pattern to the convex hulls.\n\thull = hull.data(hullsData, d => d[0].id);\n\thull.exit().remove();\n\thull = hull.enter().append(\"path\")\n\t\t.classed('hull', true)\n\t\t.attr('fill', d => color(d[0].category))\n\t\t.style('opacity', .25)\n\t\t.merge(hull);\n\n\tsimulation.nodes(nodes);\n\tif(simulation.force(\"link\")) {\n\t\tsimulation.force(\"link\").links(links);\n\t}\n\tsimulation.alpha(1).restart();\n\n}\n\nV.filter = (filter, selectLabelsArr) => {\n\t// console.log('viz', filter)\n\tapplyFilter(filter, 'do reset');\n\tif (selectLabelsArr && selectLabelsArr.length!==originalData.length) {\n\t\tselectLabelsArr.forEach(an_id => {\n\t\t\tconst obj = { id: an_id }\n\t\t\tselectLabel(obj)\n\t\t})\n\t}\n}\n\nV.openOnSearch = (arr) => {\n\tlet parents2open = [];\n\tarr.forEach(s => {\n\t\tsearch4Parent(s);\n\t});\n\n\t// console.log(parents2open);\n\n\tfunction search4Parent(nodeId) {\n\t\tconst thisNode = originalData.filter(od => od.id === nodeId)[0];\n\t\tif(thisNode.part_of !== \"\") {\n\t\t\tparents2open.push(thisNode.part_of);\n\t\t\tsearch4Parent(thisNode.part_of);\n\t\t}\n\t}\n\n\tif(parents2open.length > 0) {\n\t\tparents2open.reverse().forEach((parentId, i) => {\n\t\t\tconst parent_id = originalData.filter(od => od.id === parentId)[0].id;\n\t\t\t// surviveFilters[2].push(parent_id);\n\t\t\tconst parent = nodes.filter(d => d.id === parent_id)[0]\n\t\t\topenSubnodes(parent, 'do not restart the force');\n\t\t})\n\n\t\tV.update()\n\t}\n\n}\n\nV.openAll = () => {\n\trunAll(nodes);\n\n\tfunction runAll(nodesList) {\n\t\tnodesList.forEach(n => {\n\t\t\tif(n.totalSubNodes > 0) {\n\t\t\t\topenSubnodes(n, 'do not restart simulation');\n\t\t\t\trunAll(n.subNodes);\n\t\t\t}\n\t\t});\n\t}\n}\n\nV.closeAll = () => {\n\tnodes.filter(d => d.part_of === '').forEach(function(d) {\n\t\tcloseSubnodes(d, 'do not restart simulation');\n\t})\n}\n\nV.destroy = () => {}\n\n// Other functions\nconst openSubnodes = (d, doRestart) => {\n\t// If it happens that the node is already open, just skip.\n\tif(d.opened) return;\n\n\t// If not, let's open it\n\td.opened = true;\n\n\t// fix the position only if it is a \"root node\"\n\tif(d.part_of === '') {\n\t\td.fx = d.x;\n\t\td.fy = d.y;\n\t} else {\n\t\td.x = nodes.filter(n => n.id === d.part_of)[0].x\n\t\td.fy = nodes.filter(n => n.id === d.part_of)[0].y + r.range()[0] * 2 * 3\n\t}\n\n\t// make subnodes appear at the place of their parent\n\td.subNodes.forEach(function(subNode) {\n\t\tsubNode.x = d.x;\n\t\tsubNode.y = d.y;\n\t\t// subNode.isSelected = true;\n\t})\n\n\t// Make convex hull\n\tvar thisHullNodes = [d].concat(d.subNodes); // first element in array is always the one opened, so we can use its ID as identifier for the convex hull\n\thullsData.push(thisHullNodes);\n\n\t// check if the first point of the hull is inside another hulls\n\t// if so it means this hull should be part of that opened\n\t// add these points to that hullsData\n\thullsData.forEach(function(thisHull) {\n\t\t// if the element is in the array, but is not the first\n\t\tif(thisHull.indexOf(thisHullNodes[0]) > 0) {\n\t\t\tthisHullNodes.forEach(function(n, i) {\n\t\t\t\tif(i !== 0) {\n\t\t\t\t\tthisHull.push(n);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t})\n\n\t// calculate Graph\n\tvar augmentedNodes = nodes.concat(d.subNodes);\n\tgraph = ParseMatrixData.calculateNetwork(augmentedNodes);\n\tnodes = graph.nodes;\n\tlinks = graph.edges;\n\tif(doRestart === 'restart the force') {\n\t\tV.update();\n\t}\n}\nconst closeSubnodes = (d, doRestart) => {\n\t// If it is already opened or if it has no children, just skip\n\tif(!d.opened || d.totalSubNodes === 0) return;\n\n\td.opened = false;\n\tdelete d.fx;\n\tdelete d.fy;\n\n\tvar subNodes2Remove = [];\n\tvar hulls2Remove = [d.id]\n\n\t// recursive functions, it makes possible to close contained cluster of nodes\n\tfunction collectSubNodes(parentNode) {\n\t\tparentNode.subNodes.forEach(childNode => {\n\t\t\tif(childNode.opened) {\n\t\t\t\tchildNode.opened = false;\n\t\t\t\thulls2Remove.push(childNode.id);\n\t\t\t\tcollectSubNodes(childNode);\n\t\t\t}\n\t\t});\n\t\tsubNodes2Remove.push(parentNode.subNodes);\n\t}\n\n\tcollectSubNodes(d);\n\n\t// cycle in the subNodes2Remove array and for each list of sub-nodes to be removed remove and re-calculate the network.\n\t// Probably not the best way, but the simplest at the moment of the coding.\n\tsubNodes2Remove.forEach(subNodes => {\n\n\t\tlet toRemove = subNodes.map(d => d.id)\n\t\tlet filtered = nodes.filter(el => {\n\t\t\treturn !toRemove.includes(el.id);\n\t\t})\n\n\t\t// remove this hull\n\t\thullsData = hullsData.filter(function(h) {\n\t\t\treturn !hulls2Remove.includes(h[0].id);\n\t\t})\n\n\t\t// remove extra points from the outer hull\n\t\thullsData.forEach(function(thisHull, i) {\n\t\t\thullsData[i] = thisHull.filter(function(n) {\n\t\t\t\treturn !toRemove.includes(n.id);\n\t\t\t})\n\t\t})\n\n\t\t// calculate graph\n\t\tgraph = ParseMatrixData.calculateNetwork(filtered)\n\t\tnodes = graph.nodes;\n\t\tlinks = graph.edges;\n\t})\n\n\tif(doRestart === 'restart the force') {\n\t\tV.update();\n\t}\n}\nconst toggleSubnodes = (d, doRestart) => {\n\t// console.log(\"Ohhhhh, let's toggle the sub nodes of\", d.label, d.id)\n\tif(d.opened) {\n\t\tunselectLabel(d);\n\t\tcloseSubnodes(d, doRestart);\n\t} else if(d.subNodes && d.subNodes.length) {\n\t\tselectLabel(d);\n\t\topenSubnodes(d, doRestart);\n\t} else {\n\t\tconsole.log('No nodes to expand');\n\t}\n}\n\n// Interactions\nconst displayTitle = (arr) => {\n\t// show composition title\n\tinformation = information.data(arr, function(d) { return d.id; });\n\tinformation.exit().remove();\n\tinformation = information.enter().append(\"text\")\n\t\t.classed('information', true)\n\t\t.attr('text-anchor', d => (x(d.year) >= width / 2) ? 'end' : 'start')\n\t\t.attr('x', d => (x(d.year) >= width / 2) ? x(d.year) + 4.8 : x(d.year) - 3.2)\n\t\t.attr('y', height - 10)\n\t\t.text(d => (x(d.year) >= width / 2) ? d.sourceTitle + ' ↓' : '↓ ' + d.sourceTitle)\n\t\t.merge(information);\n}\n\nconst selectLabel = (d) => {\n\tlabel.filter(l => l.id === d.id).classed('selected', true)\n}\nconst unselectLabel = (d) => {\n\tlabel.filter(l => l.id === d.id).classed('selected', false)\n}\n\nconst selectNode = (d) => {\n\tsvg.classed('there-is-selection', true)\n\tnode.filter(n => n.id === d.id).classed('selected', true)\n}\nconst unselectNode = (d) => {\n\tnode.filter(n => n.id === d.id).classed('selected', false)\n\n\tif(svg.selectAll('.selected').size() === 0) {\n\t\tsvg.classed('there-is-selection', false)\n\t}\n}\n\nconst applyFilter = (filter, doReset) => {\n\tif (doReset==='do reset') {reset();}\n\tsvg.classed('there-is-filter', true)\n\tnode.classed('filtered', false).filter(n => filter.indexOf(n.id) < 0).classed('filtered', true)\n}\n\nconst selectSameComposition = (d) => {\n\tsvg.classed('there-is-selection', true)\n\tnode.filter(n => n.source === d.source).classed('selected', true)\n}\nconst unselectSameComposition = (d) => {\n\tnode.filter(n => n.source === d.source).classed('selected', false)\n\n\tif(svg.selectAll('.selected').size() === 0) {\n\t\tsvg.classed('there-is-selection', false)\n\t}\n}\n\nconst reset = () => {\n\tsvg.selectAll('*').classed('selected', false).classed('zoom-selected', false);\n\tnode.classed('filtered', false)\n\tsvg.selectAll('.tick').classed('cat-selected', false).selectAll('rect').attr('fill', 'transparent')\n\tsvg.classed('there-is-selection', false)\n\tdisplayTitle([]);\n}\n\n//\n//\n//\n//\n// convex hull from http://bl.ocks.org/hollasch/f70f1fe7700f092b5a505e3efd1d9232\n//\n//\n//\n//\n\nvar hullPadding = collisionPadding;\n\nvar vecScale = function(scale, v) {\n\t// Returns the vector 'v' scaled by 'scale'.\n\treturn [scale * v[0], scale * v[1]];\n}\n\nvar vecSum = function(pv1, pv2) {\n\t// Returns the sum of two vectors, or a combination of a point and a vector.\n\treturn [pv1[0] + pv2[0], pv1[1] + pv2[1]];\n}\n\nvar unitNormal = function(p0, p1) {\n\t// Returns the unit normal to the line segment from p0 to p1.\n\tvar n = [p0[1] - p1[1], p1[0] - p0[0]];\n\tvar nLength = Math.sqrt(n[0] * n[0] + n[1] * n[1]);\n\treturn [n[0] / nLength, n[1] / nLength];\n};\n\nvar strictHull = function(polyPoints) {\n\t// This method returns a polygon given the specified points. The points are assumed to be in polygon order.\n\treturn (\n\t\t'M ' + polyPoints[0] +\n\t\t' L ' +\n\t\td3.range(1, polyPoints.length)\n\t\t.map(function(i) { return polyPoints[i]; })\n\t\t.join(' L') +\n\t\t' Z'\n\t);\n};\n\nvar roundedHull = function(polyPoints, data) {\n\t// Returns the SVG path data string representing the polygon, expanded and rounded.\n\thullPadding = d3.max(data, function(d) {\n\t\treturn d.opened ? r(1) + collisionPadding : r(d.totalSubNodes + 1) + collisionPadding;\n\t})\n\n\t// Handle special cases\n\tif(!polyPoints || polyPoints.length < 1) return \"\";\n\tif(polyPoints.length === 1) return roundedHull1(polyPoints, data);\n\tif(polyPoints.length === 2) return roundedHull2(polyPoints, data);\n\n\tvar segments = new Array(polyPoints.length);\n\n\t// Calculate each offset (outwards) segment of the convex hull.\n\tfor(var segmentIndex = 0; segmentIndex < segments.length; ++segmentIndex) {\n\t\tvar p0 = (segmentIndex === 0) ? polyPoints[polyPoints.length - 1] : polyPoints[segmentIndex - 1];\n\t\tvar p1 = polyPoints[segmentIndex];\n\n\t\t// Compute the offset vector for the line segment, with length = hullPadding.\n\t\tvar offset = vecScale(hullPadding, unitNormal(p0, p1));\n\n\t\tsegments[segmentIndex] = [vecSum(p0, offset), vecSum(p1, offset)];\n\t}\n\n\tvar arcData = 'A ' + [hullPadding, hullPadding, '0,0,0,'].join(',');\n\n\tsegments = segments.map(function(segment, index) {\n\t\tvar pathFragment = \"\";\n\t\tif(index === 0) {\n\t\t\tpathFragment = 'M ' + segments[segments.length - 1][1] + ' ';\n\t\t}\n\t\tpathFragment += arcData + segment[0] + ' L ' + segment[1];\n\n\t\treturn pathFragment;\n\t});\n\n\treturn segments.join(' ');\n}\n\nvar roundedHull1 = function(polyPoints, data) {\n\t// Returns the path for a rounded hull around a single point (a circle).\n\n\tvar p1 = [polyPoints[0][0], polyPoints[0][1] - hullPadding];\n\tvar p2 = [polyPoints[0][0], polyPoints[0][1] + hullPadding];\n\n\treturn 'M ' + p1 +\n\t\t' A ' + [hullPadding, hullPadding, '0,0,0', p2].join(',') +\n\t\t' A ' + [hullPadding, hullPadding, '0,0,0', p1].join(',');\n};\n\nvar roundedHull2 = function(polyPoints, data) {\n\t// Returns the path for a rounded hull around two points (a \"capsule\" shape).\n\n\tvar offsetVector = vecScale(hullPadding, unitNormal(polyPoints[0], polyPoints[1]));\n\tvar invOffsetVector = vecScale(-1, offsetVector);\n\n\tvar p0 = vecSum(polyPoints[0], offsetVector);\n\tvar p1 = vecSum(polyPoints[1], offsetVector);\n\tvar p2 = vecSum(polyPoints[1], invOffsetVector);\n\tvar p3 = vecSum(polyPoints[0], invOffsetVector);\n\n\treturn 'M ' + p0 +\n\t\t' L ' + p1 + ' A ' + [hullPadding, hullPadding, '0,0,0', p2].join(',') +\n\t\t' L ' + p3 + ' A ' + [hullPadding, hullPadding, '0,0,0', p0].join(',');\n};\n","import React, { Component } from 'react';\nimport './PlacesMatrix.css'\nimport V from './matrix.d3'\n\nclass PlacesMatrix extends Component {\n\n  componentDidMount() {\n    // console.log('componentDidMount')\n    V.initialize(this._rootNode, this.props.data, this.props.originalData)\n    V.update(this.props.timeFilter);\n    V.filter(this.props.filter)\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // console.log('componentDidUpdate')\n\n    if (this.props.filter !== prevProps.filter) {\n      if (this.props.searched.length !== this.props.originalData.length) {\n        V.openOnSearch(this.props.searched)\n      }\n      const selectThoseLabels = this.props.searched;\n      V.filter(this.props.filter, selectThoseLabels)\n    }\n\n    if (this.props.timeFilter !== prevProps.timeFilter) {\n      V.update(this.props.timeFilter)\n    }\n\n    if (this.props.gruppi !== prevProps.gruppi) {\n      console.log(this.props.gruppi)\n      if (this.props.gruppi === 'aperti') {\n        V.openAll();\n      } else if (this.props.gruppi === 'chiusi') {\n        V.closeAll();\n      }\n      V.update();\n    }\n  }\n\n  componentWillUnmount() {\n    console.log('componentWillUnmount')\n    V.destroy(this._rootNode);\n  }\n\n  _setRef(componentNode) {\n      this._rootNode = componentNode;\n  }\n\n  render() {\n    const style={\n      width: '100%',\n      height: '100%'\n    }\n    return <svg id={this.props.id} style={style} ref={this._setRef.bind(this)}></svg>\n  }\n}\n\nexport default PlacesMatrix;\n","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport _ from 'lodash';\n\nimport GlobalData from '../GlobalData';\n\nimport MainMenu from '../general/MainMenu';\nimport PageTitle from '../general/PageTitle';\nimport MoreInfo from '../general/MoreInfo';\nimport Bussola from '../general/Bussola';\n\nimport Loading from '../general/Loading';\n\nimport Options from '../general/Options';\nimport Search from '../general/Search';\nimport RangeFilter from '../general/RangeFilter';\n\nimport PlacesMatrix from '../visualizations/PlacesMatrix';\nimport ParseMatrixData from '../utilities/parse-matrix-data';\n\nclass Trasformare extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.changeCercaPer = this.changeCercaPer.bind(this);\n\t\tthis.changeRicerca = this.changeRicerca.bind(this);\n\n\t\tthis.changeGruppi = this.changeGruppi.bind(this);\n\t\tthis.changePubblicazioni = this.changePubblicazioni.bind(this);\n\t\tthis.changeAmbienti = this.changeAmbienti.bind(this);\n\t\tthis.changeTimeSpan = this.changeTimeSpan.bind(this);\n\n    this.downloadData = this.downloadData.bind(this);\n\n\t\tthis.state = {\n\t\t\tdata: 'data still not loaded',\n\t\t\tfilter: [],\n\t\t\tisLoading: true,\n\t\t\tcerca_per: {\n\t\t\t\tmultiple: false,\n\t\t\t\toptions: [{\n\t\t\t\t\t'label': 'luogo',\n\t\t\t\t\t'status': true\n\t\t\t\t}, {\n\t\t\t\t\t'label': 'titolo pubblicazione',\n\t\t\t\t\t'status': false\n\t\t\t\t}, {\n\t\t\t\t\t'label': 'titolo',\n\t\t\t\t\t'status': false\n\t\t\t\t}]\n\t\t\t},\n\t\t\tgruppi: {\n\t\t\t\tmultiple: false,\n\t\t\t\toptions: [{\n\t\t\t\t\t'label': 'aperti',\n\t\t\t\t\t'status': false\n\t\t\t\t}, {\n\t\t\t\t\t'label': 'chiusi',\n\t\t\t\t\t'status': true\n\t\t\t\t}]\n\t\t\t}\n\t\t};\n\t}\n\n\tloadData() {\n\t\td3.tsv('./places-matrix-data.tsv').then(data => {\n\t\t\tconst graph = ParseMatrixData.parser(data);\n\t\t\treturn graph;\n\t\t}).then(data => {\n\n\t\t\tlet themes = data.data.map(d => d.themes).flat()\n\t\t\tthemes = themes.filter((d, i) => themes.indexOf(d) === i)\n\t\t\tthemes = themes.filter((d) => d !== '' && d !== \" \")\n\t\t\t// console.log(themes)\n\n\t\t\tlet kinds = data.data.map(d => d.publicationType).flat()\n\t\t\tkinds = kinds.filter((d, i) => kinds.indexOf(d) === i)\n\t\t\tkinds = kinds.filter((d) => d !== '' && d !== \" \")\n\t\t\tkinds = kinds.map(d => {\n\t\t\t\treturn { 'label': d, 'status': true }\n\t\t\t})\n\t\t\t// console.log(kinds)\n\n\t\t\tlet environments = data.data.map(d => d.themes).flat()\n\t\t\tenvironments = environments.filter((d, i) => environments.indexOf(d) === i)\n\t\t\tenvironments = environments.filter((d) => d !== '' && d !== \" \")\n\t\t\tenvironments = environments.map(d => {\n\t\t\t\treturn { 'label': d, 'status': true }\n\t\t\t})\n\t\t\t// console.log(environments)\n\n\t\t\tlet allTitles = data.data.map(d => d.pubVenueTitle.split(';'));\n\t\t\tallTitles = allTitles.flat();\n\t\t\tallTitles = d3.nest().key(d => d).entries(allTitles).map(d => d.key);\n\n\t\t\tlet nodesByPublicationTitle = []\n\t\t\tallTitles.forEach(d => {\n\t\t\t\tlet publishedHere = data.data.filter(e => {\n\t\t\t\t\treturn e.pubVenueTitle.includes(d)\n\t\t\t\t})\n\t\t\t\tlet obj = {\n\t\t\t\t\t'label': d,\n\t\t\t\t\t'id': [publishedHere.map(d => d.id)],\n\t\t\t\t\t'status': true\n\t\t\t\t}\n\t\t\t\tnodesByPublicationTitle.push(obj)\n\t\t\t})\n\n\t\t\tlet searchByCompositionTitle = d3.nest().key(d => d.sourceTitle).entries(data.data).map(d => {\n\t\t\t\treturn {\n\t\t\t\t\t'label': d.key,\n\t\t\t\t\t'id': d.values.map(dd => dd.id),\n\t\t\t\t\t'status': true\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tlet searchByLuogo = d3.nest().key(d => d.label).entries(data.data).map(d => {\n\t\t\t\treturn {\n\t\t\t\t\t'label': d.key,\n\t\t\t\t\t'id': d.values.map(dd => dd.id),\n\t\t\t\t\t'status': true\n\t\t\t\t}\n\t\t\t}).sort((a, b) => a.label.localeCompare(b.label))\n\n\t\t\tlet data_research = {\n\t\t\t\t// luogo: data.data.map(d=>{ return { 'label':d.label, 'id': [d.id], 'status': true } }),\n\t\t\t\tluogo: searchByLuogo,\n\t\t\t\t'titolo pubblicazione': nodesByPublicationTitle,\n\t\t\t\ttitolo: searchByCompositionTitle\n\t\t\t}\n\n\t\t\tlet time = d3.extent(data.data, d => d.year)\n\t\t\t// console.log(time)\n\n\t\t\tthis.setState({\n\t\t\t\tdata: data.graph,\n\t\t\t\toriginalData: data.data,\n\t\t\t\tfilter: data.data.map(d => d.id),\n\t\t\t\tnoFilter: data.data.map(d => d.id),\n\t\t\t\tisLoading: false,\n\t\t\t\tdata_research: data_research,\n\t\t\t\tricerca: {\n\t\t\t\t\toptions: data_research.luogo\n\t\t\t\t},\n\t\t\t\ttoPreserveRicerca: data.data.map(d => d.id),\n\t\t\t\tpubblicazioni: {\n\t\t\t\t\tmultiple: true,\n\t\t\t\t\toptions: kinds\n\t\t\t\t},\n\t\t\t\ttoPreservePubblicazioni: data.data.map(d => d.id),\n\t\t\t\tvolumi: {\n\t\t\t\t\tmultiple: true,\n\t\t\t\t\toptions: GlobalData.allVolumes.map(d => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...d,\n\t\t\t\t\t\t\t'status': true\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\ttoPreserveVolumi: data.data.map(d => d.id),\n\t\t\t\tambienti: {\n\t\t\t\t\tmultiple: true,\n\t\t\t\t\toptions: environments\n\t\t\t\t},\n\t\t\t\ttoPreserveAmbienti: data.data.map(d => d.id),\n\t\t\t\ttimeExtent: time,\n\t\t\t\ttimeFilter: time,\n\t\t\t\tupdate: false\n\t\t\t})\n\t\t})\n\t}\n\n\tchangeCercaPer(newOptions) {\n\t\tlet selection = newOptions.filter(d => d.status)\n\t\tif(selection.length < 1) {\n\t\t\tconsole.error('err');\n\t\t\treturn;\n\t\t}\n\t\tselection = selection[0].label\n\t\tconsole.log(selection)\n\n\t\tlet research_options = this.state.data_research[selection];\n\n\t\tthis.setState(prevState => ({\n\t\t\tcerca_per: {\n\t\t\t\t...prevState.cerca_per,\n\t\t\t\toptions: newOptions\n\t\t\t},\n\t\t\tricerca: {\n\t\t\t\t...prevState.ricerca,\n\t\t\t\toptions: research_options\n\t\t\t}\n\t\t}))\n\t}\n\n\tchangeRicerca(newOptions) {\n\n\t\tlet toPreserve = newOptions.map(d => d.id)\n\t\ttoPreserve = _.flattenDeep(toPreserve)\n\t\t// console.log(toPreserve)\n\n\t\tthis.setState(prevState => ({\n\t\t\tricerca: {\n\t\t\t\t...prevState.ricerca,\n\t\t\t\t// options: newOptions\n\t\t\t},\n\t\t\ttoPreserveRicerca: toPreserve,\n\t\t\tfilter: _.intersection(prevState.noFilter, toPreserve, prevState.toPreservePubblicazioni, prevState.toPreserveVolumi, prevState.toPreserveAmbienti)\n\t\t}))\n\n\t}\n\n\tchangeGruppi(newOptions) {\n\t\tthis.setState({\n\t\t\tstatoGruppi: newOptions.filter(d => d.status)[0].label\n\t\t})\n\t}\n\n\tchangePubblicazioni(newOptions) {\n\n\t\tconst criteria = newOptions.filter(d => d.status).map(d => d.label)\n\t\tconst toPreserve = this.state.originalData.filter(node => {\n\t\t\treturn node.publicationType.filter(value => criteria.includes(value)).length > 0\n\t\t}).map(d => d.id)\n\t\tconsole.log(toPreserve.length)\n\n\t\tthis.setState(prevState => ({\n\t\t\tpubblicazioni: {\n\t\t\t\t...prevState.pubblicazioni,\n\t\t\t\toptions: newOptions\n\t\t\t},\n\t\t\ttoPreservePubblicazioni: toPreserve,\n\t\t\tfilter: _.intersection(prevState.noFilter, prevState.toPreserveRicerca, toPreserve, prevState.toPreserveVolumi, prevState.toPreserveAmbienti)\n\t\t}))\n\t}\n\n\tchangeAmbienti(newOptions) {\n\n\t\tconst criteria = newOptions.filter(d => d.status).map(d => d.label)\n\t\tconst toPreserve = this.state.originalData.filter(node => {\n\t\t\treturn node.themes.filter(value => criteria.includes(value)).length > 0\n\t\t}).map(d => d.id)\n\t\t// console.log(toPreserve.length)\n\n\t\t// this.filterData()\n\n\t\tthis.setState(prevState => ({\n\t\t\tambienti: {\n\t\t\t\t...prevState.ambienti,\n\t\t\t\toptions: newOptions\n\t\t\t},\n\t\t\ttoPreserveAmbienti: toPreserve,\n\t\t\tfilter: _.intersection(prevState.noFilter, prevState.toPreserveRicerca, prevState.toPreservePubblicazioni, prevState.toPreserveVolumi, toPreserve)\n\t\t}))\n\t}\n\n\tchangeTimeSpan(newOptions) {\n\t\tnewOptions = newOptions.map(d => {\n\t\t\treturn +new Date(d)\n\t\t})\n\t\tthis.setState({ 'timeFilter': newOptions })\n\t}\n\n\tdownloadData(event) {\n\t\tif(event.key !== 'd') return;\n\n    console.log(this.state)\n\n    const selected = d3.selectAll('.selected, .filtered')\n  \tlet selectedData = selected.data()\n\n  \tselectedData = d3.nest()\n  \t\t.key(d => d.source)\n  \t\t.entries(selectedData)\n  \t\t.map(d => {\n  \t\t\treturn {\n  \t\t\t\t'composition_id': d.key,\n  \t\t\t\t'composition_title': d.values[0].sourceTitle\n  \t\t\t}\n  \t\t})\n\n    let export_data = 'Compositions titles surviving filters\\n\\n';\n\n    export_data += `Ambienti attivati: ${this.state.ambienti.options.filter(d=>d.status).map(d=>d.label).join(', ')}\\n`\n    export_data += `Pubblicazioni attivate: ${this.state.pubblicazioni.options.filter(d=>d.status).map(d=>d.label).join(', ')}\\n`\n    export_data += `Ricerca effettuata: ${this.state.toPreserveRicerca.map(d=>this.state.originalData.find(e=>e.id===d).label).join(', ')}\\n`\n    export_data += `\\n\\n`\n\n    export_data += `composition_id\\tcomposition_title\\n`\n    selectedData.forEach(d=>{\n    \texport_data += d.composition_id + '\\t' + d.composition_title + \"\\n\"\n    })\n\n  \tlet the_date = new Date()\n  \tthe_date = d3.timeFormat(\"%Y_%m_%d %X\")(the_date)\n\n  \tdownload(export_data, `selection [${the_date}].txt`, 'text/plain')\n\n  \t// Function to download data to a file\n  \tfunction download(data, filename, type) {\n  \t\tconsole.log('download')\n  \t\tvar file = new Blob([data], { type: type });\n  \t\tif(window.navigator.msSaveOrOpenBlob) // IE10+\n  \t\t\twindow.navigator.msSaveOrOpenBlob(file, filename);\n  \t\telse { // Others\n  \t\t\tvar a = document.createElement(\"a\"),\n  \t\t\t\turl = URL.createObjectURL(file);\n  \t\t\ta.href = url;\n  \t\t\ta.download = filename;\n  \t\t\tdocument.body.appendChild(a);\n  \t\t\ta.click();\n  \t\t\tsetTimeout(function() {\n  \t\t\t\tdocument.body.removeChild(a);\n  \t\t\t\twindow.URL.revokeObjectURL(url);\n  \t\t\t}, 0);\n  \t\t}\n  \t}\n\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.loadData();\n\t\tdocument.addEventListener(\"keypress\", this.downloadData);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tdocument.removeEventListener(\"keypress\", this.downloadData);\n\t}\n\n\trender() {\n\t\t// console.log(this.state)\n\n\t\treturn (\n\t\t\t<div className = \"trasformare main\">\n\t\t\t\t<div className = \"top-nav navigations\">\n\t\t\t\t\t<MainMenu className = \"main-menu\" style = {{gridColumn: 'span 1'}}/>\n\t\t\t\t\t<PageTitle title = {this.props.title} style = {{gridColumn: 'span 10'}}/>\n\n\t\t\t\t\t{ this.state.isLoading && < Loading style = {{gridColumn: 'span 3'}}/> }\n\n\t\t\t\t\t{\n\t\t!this.state.isLoading && < Options title = \"Cerca per\"\n\t\tdata = {\n\t\t\tthis.state.cerca_per\n\t\t}\n\t\tstyle = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 3'\n\t\t\t}\n\t\t}\n\t\tchangeOptions = {\n\t\t\tthis.changeCercaPer\n\t\t}\n\t\t/>\n\t} {\n\t\tthis.state.isLoading && < Loading style = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 8'\n\t\t\t}\n\t\t}\n\t\t/>\n\t} {\n\t\t!this.state.isLoading && < Search style = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 8'\n\t\t\t}\n\t\t}\n\t\tdata = {\n\t\t\tthis.state.ricerca\n\t\t}\n\t\tchangeOptions = {\n\t\t\tthis.changeRicerca\n\t\t}\n\t\t/ >\n\t} < MoreInfo style = {\n\t\t{\n\t\t\tgridColumn: 'span 1'\n\t\t}\n\t}\n\t/> <Bussola style = { {\n\tgridColumn: 'span 1'\n}\n}\n/> < /\ndiv >\n\n\t<div className = \"the-body-viz\" >\n\n\t\t{this.state.isLoading && <Loading/>}\n\t\t{\t!this.state.isLoading &&\n\t\t\t<PlacesMatrix\n\t\t\t\tdata = {this.state.data}\n\t\t\t\toriginalData = {this.state.originalData}\n\t\t\t\tfilter = {this.state.filter}\n\t\t\t\tsearched = {this.state.toPreserveRicerca}\n\t\t\t\ttimeFilter = {this.state.timeFilter}\n\t\t\t\tgruppi = {this.state.gruppi.options.filter(d => d.status)[0].label}\n\t\t\t/> }\n\n\t</div>\n\n\t<div className = \"bottom-nav navigations\">\n\n\t{\n\t\tthis.state.isLoading && < Loading style = { { gridColumn: 'span 5' } }\n\t\t/ >\n\t} {\n\t\t!this.state.isLoading && < Options title = \"Gruppi\"\n\t\tdata = {\n\t\t\tthis.state.gruppi\n\t\t}\n\t\tstyle = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 5',\n\t\t\t\ttextAlign: 'center'\n\t\t\t}\n\t\t}\n\t\tchangeOptions = {\n\t\t\tthis.changeGruppi\n\t\t}\n\t\t/>\n\t} {\n\t\tthis.state.isLoading && < Loading style = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 5'\n\t\t\t}\n\t\t}\n\t\t/>\n\t} {\n\t\t!this.state.isLoading && < Options title = \"Pubblicazioni\"\n\t\tdata = {\n\t\t\tthis.state.pubblicazioni\n\t\t}\n\t\tstyle = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 5',\n\t\t\t\ttextAlign: 'center'\n\t\t\t}\n\t\t}\n\t\tchangeOptions = {\n\t\t\tthis.changePubblicazioni\n\t\t}\n\t\t/>\n\t} {\n\t\tthis.state.isLoading && < Loading style = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 5'\n\t\t\t}\n\t\t}\n\t\t/>\n\t} {\n\t\t!this.state.isLoading && < Options title = \"Ambienti\"\n\t\tdata = {\n\t\t\tthis.state.ambienti\n\t\t}\n\t\tstyle = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 5',\n\t\t\t\ttextAlign: 'center'\n\t\t\t}\n\t\t}\n\t\tchangeOptions = {\n\t\t\tthis.changeAmbienti\n\t\t}\n\t\t/>\n\t} {\n\t\tthis.state.isLoading && < Loading style = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 9'\n\t\t\t}\n\t\t}\n\t\t/>\n\t} {\n\t\t!this.state.isLoading && < RangeFilter style = {\n\t\t\t{\n\t\t\t\tgridColumn: 'span 9'\n\t\t\t}\n\t\t}\n\t\tdata = {\n\t\t\tthis.state.timeExtent\n\t\t}\n\t\tchangeOptions = {\n\t\t\tthis.changeTimeSpan\n\t\t}\n\t\t/>\n\t} < /\ndiv > <\n\t/div >);\n}\n}\n\nexport default Trasformare;\n","import React from 'react';\nimport './general/HK Grotesk/WEB/stylesheet.css';\nimport './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n// import PlacesMatrixView from './PlacesMatrixView/PlacesMatrixView';\nimport Trasformare from './Trasformare/Trasformare';\n// import ContainerComp from './ContainerComp/ContainerComp';\n\nfunction App() {\n  return (\n    <div className=\"main\">\n        <Trasformare />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}